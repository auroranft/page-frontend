import{u as Ne}from"./useWeb3-5d18194c.mjs";import{d as he,w as Re,r as O,e as Te,o as T,c as $,a as d,n as $e,i as y,s as D,v as Z,t as ee,I as ae,h as J,g as fe,R as Ie,S as sa,T as ra,V as m,W as na,X as oa,Y as ca,Z as c,$ as l,a0 as A,a1 as w,a2 as ia,a3 as I,a4 as te,a5 as Ae,a6 as la,a7 as da,a8 as ua,a9 as je,aa as ha,ab as Be,ac as fa,ad as pe,ae as ma,af as ya,ag as pa,ah as ga,ai as wa,aj as ba,ak as va,u as _a,N as M,x as Pa,F as ge,f as we,j as z,k as Ue,al as Ea,K as ke}from"./entry-58e7afa6.mjs";import{u as xe,b as De,a as Le}from"./useSubmit-99431132.mjs";import{M as K,a as H,i as be,b as Ca,c as Sa}from"./Market_abi-93ee176c.mjs";import{_ as Na}from"./ConnectBtn-feb3cc6b.mjs";import{T as ve}from"./TokenERC20_abi-e6f25529.mjs";const Ra={name:null,symbol:null,royalty:0,verifyRights:!1,agreenTerms:!1},Ta={style:{display:"inline-block"}},$a=d("button",{type:"button",class:"btn btn-outline-primary",style:{"--bs-btn-padding-y":".25rem","--bs-btn-padding-x":".5rem","--bs-btn-font-size":".75rem"},"data-bs-toggle":"modal","data-bs-target":"#modalAddCollection"},[d("i",{class:"bi bi-plus"})],-1),Ia={class:"modal fade",id:"modalAddCollection",tabindex:"-1","aria-labelledby":"modalAddCollectionLabel","aria-hidden":"true"},Aa={class:"modal-dialog modal-lg modal-dialog-centered"},ja={class:"modal-content"},Ba=d("div",{class:"modal-header"},[d("h5",{class:"modal-title",id:"modalAddCollectionLabel"},"Create New Collection"),d("button",{id:"closeModalAddCollection",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ua={class:"modal-body"},ka={class:"row g-5"},xa={class:"col"},Da=d("p",{class:"fw-lighter"},"When creating a new collection, you are deploying your own contract to the blockchain! NFTrade charges zero platform transaction fees, so you only need to pay for the network gas fees. This is a collection under your own unique contract, meaning you are the owner of the contract and you'll be able to add as many NFTs to that collection as you'd like. Your minted tokens will receive incremental IDs starting from 1, increasing with each new NFT in the collection.",-1),La=d("p",{class:"fw-lighter"},"Since this is a unique contract address, you will have the opportunity to verify your collection later on.",-1),Fa={class:"my-4"},Oa=d("label",{for:"name",class:"form-label"},"Name",-1),Ma=d("p",{class:"fw-lighter"},"Crypto Punks / Meebits / etc..",-1),Ha=d("div",{class:"invalid-feedback"}," You must choose a name ",-1),qa={class:"my-4"},Va=d("label",{for:"symbol",class:"form-label"},"Symbol",-1),za=d("p",{class:"fw-lighter"},"CPNKS / MBTS / etc..",-1),Ka=d("div",{class:"invalid-feedback"}," You must choose a symbol ",-1),Xa={class:"my-4"},Ga={for:"royaltyRate",class:"form-label"},Wa=["max","value"],Ya=d("div",{class:"my-4"},null,-1),Qa={class:"form-check"},Ja=d("label",{class:"form-check-label fw-lighter",for:"verifyRights"},"I verify I am minting a unique collection and that this is not a reproduction, stolen intellectual property, or a scam.",-1),Za={class:"form-check"},et=d("label",{class:"form-check-label fw-lighter",for:"agreenTerms"},"I approve NFTrade's Terms & Conditions",-1),at=d("hr",{class:"my-4"},null,-1),tt=["disabled"],st={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},rt=he({__name:"addCollection",setup(e){const{account:t,library:a,chainId:s}=Ne();Re([t,a,s],()=>{!!t.value&&!!a.value&&!!s.value&&b()});const r=xe(),n=De(),o=Le(),i=Ra;function u(){n.value=!0,r.value=!0,i.royalty=h.value,i.name&&i.symbol&&i.verifyRights&&i.agreenTerms?new a.value.eth.Contract(K,H[s.value]).methods.addCollection(i.name,i.symbol,i.royalty).send({from:t.value}).on("error",function(){r.value=!1,document.getElementById("closeModalAddCollection").click()}).then(()=>{o.value=Date.parse(new Date().toString()),r.value=!1,document.getElementById("closeModalAddCollection").click()}):r.value=!1}const h=O(0),f=O(0);async function b(){const p=new a.value.eth.Contract(K,H[s.value]);f.value=await p.methods.maxRoyaltyRate().call({from:t.value})}function S(p){h.value=p.target.value}return Te(()=>{b()}),(p,v)=>(T(),$("div",Ta,[$a,d("div",Ia,[d("div",Aa,[d("div",ja,[Ba,d("div",Ua,[d("div",ka,[d("div",xa,[Da,La,d("form",{class:$e(`needs-validation ${y(n)?"was-validated":""}`),novalidate:""},[d("div",Fa,[Oa,Ma,D(d("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter the collection's name","onUpdate:modelValue":v[0]||(v[0]=E=>y(i).name=E),required:""},null,512),[[Z,y(i).name]]),Ha]),d("div",qa,[Va,za,D(d("input",{type:"text",class:"form-control",id:"symbol",placeholder:"Enter the collection's symbol","onUpdate:modelValue":v[1]||(v[1]=E=>y(i).symbol=E),required:""},null,512),[[Z,y(i).symbol]]),Ka]),d("div",Xa,[d("label",Ga,"RoyaltyRate: "+ee(h.value)+" %",1),d("input",{type:"range",class:"form-range",min:"0",max:f.value,step:"1",id:"royaltyRate",value:h.value,onChange:S,required:""},null,40,Wa)]),Ya,d("div",Qa,[D(d("input",{type:"checkbox",class:"form-check-input",id:"verifyRights","onUpdate:modelValue":v[2]||(v[2]=E=>y(i).verifyRights=E),required:""},null,512),[[ae,y(i).verifyRights]]),Ja]),d("div",Za,[D(d("input",{type:"checkbox",class:"form-check-input",id:"agreenTerms","onUpdate:modelValue":v[3]||(v[3]=E=>y(i).agreenTerms=E),required:""},null,512),[[ae,y(i).agreenTerms]]),et]),at,d("button",{class:"w-100 btn btn-primary btn-lg",type:"button",disabled:y(r),onClick:u},[y(r)?(T(),$("span",st)):J("",!0),fe(" "+ee(y(r)?"Loading...":"Create Collection"),1)],8,tt)],2)])])])])])])]))}}),nt=e=>Promise.reject(new Error(`No base found for "${e}"`));class ot{constructor(t){this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase||nt;for(const a of t.bases)this.addBase(a)}addBase(t){if(this._basesByName[t.name]||this._basesByPrefix[t.prefix])throw new Error(`Codec already exists for codec "${t.name}"`);this._basesByName[t.name]=t,this._basesByPrefix[t.prefix]=t}removeBase(t){delete this._basesByName[t.name],delete this._basesByPrefix[t.prefix]}async getBase(t){if(this._basesByName[t])return this._basesByName[t];if(this._basesByPrefix[t])return this._basesByPrefix[t];const a=await this._loadBase(t);return this._basesByName[a.name]==null&&this._basesByPrefix[a.prefix]==null&&this.addBase(a),a}listBases(){return Object.values(this._basesByName)}}const ct=e=>Promise.reject(new Error(`No codec found for "${e}"`));class it{constructor(t){this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec||ct;for(const a of t.codecs)this.addCodec(a)}addCodec(t){if(this._codecsByName[t.name]||this._codecsByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._codecsByName[t.name]=t,this._codecsByCode[t.code]=t}removeCodec(t){delete this._codecsByName[t.name],delete this._codecsByCode[t.code]}async getCodec(t){const a=typeof t=="string"?this._codecsByName:this._codecsByCode;if(a[t])return a[t];const s=await this._loadCodec(t);return a[t]==null&&this.addCodec(s),s}listCodecs(){return Object.values(this._codecsByName)}}const lt=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class dt{constructor(t){this._hashersByName={},this._hashersByCode={},this._loadHasher=t.loadHasher||lt;for(const a of t.hashers)this.addHasher(a)}addHasher(t){if(this._hashersByName[t.name]||this._hashersByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._hashersByName[t.name]=t,this._hashersByCode[t.code]=t}removeHasher(t){delete this._hashersByName[t.name],delete this._hashersByCode[t.code]}async getHasher(t){const a=typeof t=="string"?this._hashersByName:this._hashersByCode;if(a[t])return a[t];const s=await this._loadHasher(t);return a[t]==null&&this.addHasher(s),s}listHashers(){return Object.values(this._hashersByName)}}const ut="dag-pb",ht=112;function ft(e){Ie(e);const t={};return e.Links&&(t.Links=e.Links.map(a=>{const s={};return a.Hash&&(s.Hash=a.Hash.bytes),a.Name!==void 0&&(s.Name=a.Name),a.Tsize!==void 0&&(s.Tsize=a.Tsize),s})),e.Data&&(t.Data=e.Data),sa(t)}function mt(e){const t=ra(e),a={};return t.Data&&(a.Data=t.Data),t.Links&&(a.Links=t.Links.map(s=>{const r={};try{r.Hash=m.decode(s.Hash)}catch{}if(!r.Hash)throw new Error("Invalid Hash field found in link, expected CID");return s.Name!==void 0&&(r.Name=s.Name),s.Tsize!==void 0&&(r.Tsize=s.Tsize),r})),a}var yt=Object.freeze(Object.defineProperty({__proto__:null,name:ut,code:ht,encode:ft,decode:mt,prepare:na,validate:Ie,createNode:oa,createLink:ca},Symbol.toStringTag,{value:"Module"}));const pt=c(e=>{async function t(a={}){return((await(await e.post("bitswap/wantlist",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).Keys||[]).map(r=>m.parse(r["/"]))}return t}),gt=c(e=>{async function t(a,s={}){return((await(await e.post("bitswap/wantlist",{signal:s.signal,searchParams:l({...s,peer:a.toString()}),headers:s.headers})).json()).Keys||[]).map(n=>m.parse(n["/"]))}return t}),Fe=c(e=>{async function t(a={}){const s=await e.post("bitswap/stat",{searchParams:l(a),signal:a.signal,headers:a.headers});return wt(await s.json())}return t});function wt(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(t=>m.parse(t["/"])),peers:(e.Peers||[]).map(t=>A(t)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const bt=c(e=>{async function t(a,s={}){return(await e.post("bitswap/unwant",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers})).json()}return t});function vt(e){return{wantlist:pt(e),wantlistForPeer:gt(e),unwant:bt(e),stat:Fe(e)}}const Oe=c(e=>{async function t(a,s={}){const r=await e.post("block/get",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers});return new Uint8Array(await r.arrayBuffer())}return t});function _t(e){const[t,a]=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],s=[];return{peek:()=>t.next(),push:r=>{s.push(r)},next:()=>s.length?{done:!1,value:s.shift()}:t.next(),[a](){return this}}}var se=_t;async function*Pt(e,t={}){const a=e.getReader();try{for(;;){const s=await a.read();if(s.done)return;yield s.value}}finally{t.preventCancel!==!0&&a.cancel(),a.releaseLock()}}var W=Pt;const Et=async e=>{const t=[];for await(const a of e)t.push(a);return t};var Me=Et;function F(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function X(e){return e.constructor&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function le(e){return typeof e=="object"&&(e.path||e.content)}const G=e=>e&&typeof e.getReader=="function";async function Ct(e){if(F(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(X(e))return e;if(G(e)&&(e=W(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=se(e),{value:a,done:s}=await t.peek();if(s)return _e(t);if(t.push(a),Number.isInteger(a))return new Blob([Uint8Array.from(await Me(t))]);if(F(a)||typeof a=="string"||a instanceof String)return _e(t)}throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function _e(e){const t=[];for await(const a of e)t.push(a);return new Blob(t)}const St=async function*(e,t){for await(const a of e)yield t(a)};var de=St;function He(e){if(e!=null)return typeof e=="number"?e&4095:(e=e.toString(),e.substring(0,1)==="0"?parseInt(e,8)&4095:parseInt(e,10)&4095)}function qe(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const a=e.getTime(),s=Math.floor(a/1e3);t={secs:s,nsecs:(a-s*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw w(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}async function*Nt(e,t){if(typeof e=="string"||e instanceof String||F(e)||X(e)||e._readableState)throw w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(G(e)&&(e=W(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const a=se(e),{value:s,done:r}=await a.peek();if(r){yield*[];return}if(a.push(s),Number.isInteger(s))throw w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(s._readableState){yield*de(a,n=>ce({content:n},t));return}if(F(s)){yield ce({content:a},t);return}if(le(s)||s[Symbol.iterator]||s[Symbol.asyncIterator]||G(s)||X(s)){yield*de(a,n=>ce(n,t));return}}throw le(e)?w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function ce(e,t){const{path:a,mode:s,mtime:r,content:n}=e,o={path:a||"",mode:He(s),mtime:qe(r)};return n?o.content=await t(n):a||(o.content=await t(e)),o}function Rt(e){return Nt(e,Ct)}function Tt(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function U(e,t,a={}){const s=[],r=new FormData;let n=0,o=0;for await(const{content:i,path:u,mode:h,mtime:f}of Rt(e)){let b="";const S=i?"file":"dir";n>0&&(b=`-${n}`);let p=S+b;const v=[];if(h!=null&&v.push(`mode=${Tt(h)}`),f!=null){const{secs:E,nsecs:x}=f;v.push(`mtime=${E}`),x!=null&&v.push(`mtime-nsecs=${x}`)}if(v.length&&(p=`${p}?${v.join("&")}`),i){r.set(p,i,u!=null?encodeURIComponent(u):void 0);const E=o+i.size;s.push({name:u,start:o,end:E}),o=E}else if(u!=null)r.set(p,new File([""],encodeURIComponent(u),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");n++}return{total:o,parts:s,headers:a,body:r}}function $t(e){return e.filter(Boolean)}function k(...e){return ia($t(e))}const It=c(e=>{async function t(a,s={}){const r=new AbortController,n=k(r.signal,s.signal);let o;try{o=await(await e.post("block/put",{signal:n,searchParams:l(s),...await U([a],r,s.headers)})).json()}catch(i){if(s.format==="dag-pb")return t(a,{...s,format:"protobuf"});if(s.format==="dag-cbor")return t(a,{...s,format:"cbor"});throw i}return m.parse(o.Key)}return t}),At=c(e=>{async function*t(a,s={}){Array.isArray(a)||(a=[a]);const r=await e.post("block/rm",{signal:s.signal,searchParams:l({arg:a.map(n=>n.toString()),"stream-channels":!0,...s}),headers:s.headers});for await(const n of r.ndjson())yield jt(n)}return t});function jt(e){const t={cid:m.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const Bt=c(e=>{async function t(a,s={}){const n=await(await e.post("block/stat",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers})).json();return{cid:m.parse(n.Key),size:n.Size}}return t});function Ut(e){return{get:Oe(e),put:It(e),rm:At(e),stat:Bt(e)}}const kt=c(e=>{async function t(a,s={}){const r=await e.post("bootstrap/add",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),{Peers:n}=await r.json();return{Peers:n.map(o=>new I(o))}}return t}),xt=c(e=>{async function t(a={}){const s=await e.post("bootstrap/rm",{signal:a.signal,searchParams:l({...a,all:!0}),headers:a.headers}),{Peers:r}=await s.json();return{Peers:r.map(n=>new I(n))}}return t}),Dt=c(e=>{async function t(a={}){const s=await e.post("bootstrap/list",{signal:a.signal,searchParams:l(a),headers:a.headers}),{Peers:r}=await s.json();return{Peers:r.map(n=>new I(n))}}return t}),Lt=c(e=>{async function t(a={}){const s=await e.post("bootstrap/add",{signal:a.signal,searchParams:l({...a,default:!0}),headers:a.headers}),{Peers:r}=await s.json();return{Peers:r.map(n=>new I(n))}}return t}),Ft=c(e=>{async function t(a,s={}){const r=await e.post("bootstrap/rm",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),{Peers:n}=await r.json();return{Peers:n.map(o=>new I(o))}}return t});function Ot(e){return{add:kt(e),clear:xt(e),list:Dt(e),reset:Lt(e),rm:Ft(e)}}const Mt=c(e=>{async function t(a,s={}){const n=await(await e.post("config/profile/apply",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json();return{original:n.OldCfg,updated:n.NewCfg}}return t});function P(e){if(e==null)return e;const t=/^[A-Z]+$/,a={};return Object.keys(e).reduce((s,r)=>(t.test(r)?s[r.toLowerCase()]=e[r]:t.test(r[0])?s[r[0].toLowerCase()+r.slice(1)]=e[r]:s[r]=e[r],s),a)}const Ht=c(e=>{async function t(a={}){return(await(await e.post("config/profile/list",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).map(n=>P(n))}return t});function qt(e){return{apply:Mt(e),list:Ht(e)}}const Vt=c(e=>async(a,s={})=>{if(!a)throw new Error("key argument is required");return(await(await e.post("config",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json()).Value}),zt=c(e=>async(a={})=>await(await e.post("config/show",{signal:a.signal,searchParams:l({...a}),headers:a.headers})).json()),Kt=c(e=>async(a,s={})=>{const r=new AbortController,n=k(r.signal,s.signal);await(await e.post("config/replace",{signal:n,searchParams:l(s),...await U([te(JSON.stringify(a))],r,s.headers)})).text()}),Xt=c(e=>async(a,s,r={})=>{if(typeof a!="string")throw new Error("Invalid key type");const n={...r,...Gt(a,s)};await(await e.post("config",{signal:r.signal,searchParams:l(n),headers:r.headers})).text()}),Gt=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function Wt(e){return{getAll:zt(e),get:Vt(e),set:Xt(e),replace:Kt(e),profiles:qt(e)}}const Yt=c(e=>{async function*t(a,s={}){yield*(await e.post("dag/export",{signal:s.signal,searchParams:l({arg:a.toString()}),headers:s.headers})).iterator()}return t});async function*Pe(e,t,a,s,r){const n=async h=>{const f=await a.getCodec(h.code),b=await s(h,r);return f.decode(b)},o=t.split("/").filter(Boolean);let i=await n(e),u=e;for(;o.length;){const h=o.shift();if(!h)throw w(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(i,h))i=i[h],yield{value:i,remainderPath:o.join("/")};else throw w(new Error(`no link named "${h}" under ${u}`),"ERR_NO_LINK");const f=m.asCID(i);f&&(u=f,i=await n(i))}yield{value:i,remainderPath:""}}const Qt=async e=>{for await(const t of e)return t};var Jt=Qt;const Zt=async e=>{let t;for await(const a of e)t=a;return t};var re=Zt;const es=(e,t)=>c((s,r)=>{const n=Oe(r);return async(i,u={})=>{if(u.path){const p=u.localResolve?await Jt(Pe(i,u.path,e,n,u)):await re(Pe(i,u.path,e,n,u));if(!p)throw w(new Error("Not found"),"ERR_NOT_FOUND");return p}const h=await e.getCodec(i.code),f=await n(i,u);return{value:h.decode(f),remainderPath:""}}})(t),as=c(e=>{async function*t(a,s={}){const r=new AbortController,n=k(r.signal,s.signal),{headers:o,body:i}=await U(a,r,s.headers),u=await e.post("dag/import",{signal:n,headers:o,body:i,searchParams:l({"pin-roots":s.pinRoots})});for await(const{Root:h}of u.ndjson())if(h!==void 0){const{Cid:{"/":f},PinErrorMsg:b}=h;yield{root:{cid:m.parse(f),pinErrorMsg:b}}}}return t}),Ve=(e,t)=>c(s=>async(n,o={})=>{const i={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o};let u;if(i.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");u=n}else u=(await e.getCodec(i.storeCodec)).encode(n),i.inputCodec=i.storeCodec;const h=new AbortController,f=k(h.signal,i.signal),S=await(await s.post("dag/put",{timeout:i.timeout,signal:f,searchParams:l(i),...await U([u],h,i.headers)})).json();return m.parse(S.Cid["/"])})(t),ts=c(e=>async(a,s={})=>{const n=await(await e.post("dag/resolve",{signal:s.signal,searchParams:l({arg:`${a}${s.path?`/${s.path}`.replace(/\/[/]+/g,"/"):""}`,...s}),headers:s.headers})).json();return{cid:m.parse(n.Cid["/"]),remainderPath:n.RemPath}});function ss(e,t){return{export:Yt(t),get:es(e,t),import:as(t),put:Ve(e,t),resolve:ts(t)}}const rs=0,ns=1,os=2,cs=3,is=4,ls=5,ds=6,us=7,q=e=>{var t;if(e.Type===rs)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===ns)return{from:A(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:a,Addrs:s})=>({id:A(a),multiaddrs:s.map(r=>new I(r)),protocols:[]})),providers:(e.Responses||[]).map(({ID:a,Addrs:s})=>({id:A(a),multiaddrs:s.map(r=>new I(r)),protocols:[]}))};if(e.Type===os){let a={id:(t=e.ID)!=null?t:A(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(a={id:A(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(s=>new I(s)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:a}}if(e.Type===cs)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===is)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:a,Addrs:s})=>({id:A(a),multiaddrs:s.map(r=>new I(r)),protocols:[]}))};if(e.Type===ls)return{name:"VALUE",type:e.Type,value:te(e.Extra,"base64pad")};if(e.Type===ds){const a=e.Responses.map(({ID:s})=>A(s));if(!a.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:a[0]}}if(e.Type===us)return{name:"DIALING_PEER",type:e.Type,peer:A(e.ID)};throw new Error("Unknown DHT event type")},hs=c(e=>{async function*t(a,s={}){const r=await e.post("dht/findpeer",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers});for await(const n of r.ndjson())yield q(n)}return t}),fs=c(e=>{async function*t(a,s={}){const r=await e.post("dht/findprovs",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers});for await(const n of r.ndjson())yield q(n)}return t}),ms=c(e=>{async function*t(a,s={}){const r=await e.post("dht/get",{signal:s.signal,searchParams:l({arg:a instanceof Uint8Array?Ae(a):a.toString(),...s}),headers:s.headers});for await(const n of r.ndjson())yield q(n)}return t}),ys=c(e=>{async function*t(a,s={recursive:!1}){const r=Array.isArray(a)?a:[a],n=await e.post("dht/provide",{signal:s.signal,searchParams:l({arg:r.map(o=>o.toString()),...s}),headers:s.headers});for await(const o of n.ndjson())yield q(o)}return t}),ps=c(e=>{async function*t(a,s,r={}){const n=new AbortController,o=k(n.signal,r.signal),i=await e.post("dht/put",{signal:o,searchParams:l({arg:a instanceof Uint8Array?Ae(a):a.toString(),...r}),...await U([s],n,r.headers)});for await(const u of i.ndjson())yield q(u)}return t}),gs=c(e=>{async function*t(a,s={}){const r=await e.post("dht/query",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers});for await(const n of r.ndjson())yield q(n)}return t});function ws(e){return{findPeer:hs(e),findProvs:fs(e),get:ms(e),provide:ys(e),put:ps(e),query:gs(e)}}const bs=c(e=>{async function t(a={}){return(await e.post("diag/cmds",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()}return t}),vs=c(e=>{async function t(a={}){return(await e.post("diag/net",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()}return t}),_s=c(e=>{async function t(a={}){return(await e.post("diag/sys",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()}return t});function Ps(e){return{cmds:bs(e),net:vs(e),sys:_s(e)}}const Es=c(e=>{async function t(a,s,r={}){await(await e.post("files/chmod",{signal:r.signal,searchParams:l({arg:a,mode:s,...r}),headers:r.headers})).text()}return t}),Cs=c(e=>{async function t(a,s,r={}){const n=Array.isArray(a)?a:[a];await(await e.post("files/cp",{signal:r.signal,searchParams:l({arg:n.concat(s).map(i=>m.asCID(i)?`/ipfs/${i}`:i),...r}),headers:r.headers})).text()}return t}),Ss=c(e=>{async function t(a,s={}){if(!a||typeof a!="string")throw new Error("ipfs.files.flush requires a path");const n=await(await e.post("files/flush",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json();return m.parse(n.Cid)}return t});function ue(e){const t=P(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const Ns=c(e=>{async function*t(a,s={}){if(!a)throw new Error("ipfs.files.ls requires a path");const r=await e.post("files/ls",{signal:s.signal,searchParams:l({arg:m.asCID(a)?`/ipfs/${a}`:a,long:!0,...s,stream:!0}),headers:s.headers});for await(const n of r.ndjson())if("Entries"in n)for(const o of n.Entries||[])yield Ee(ue(o));else yield Ee(ue(n))}return t});function Ee(e){return e.hash&&(e.cid=m.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}const Rs=c(e=>{async function t(a,s={}){await(await e.post("files/mkdir",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).text()}return t}),Ts=c(e=>{async function t(a,s,r={}){Array.isArray(a)||(a=[a]),await(await e.post("files/mv",{signal:r.signal,searchParams:l({arg:a.concat(s),...r}),headers:r.headers})).text()}return t});var $s=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:a,value:s}=await t.read();if(a)return;yield s}}finally{t.releaseLock()}}();throw new Error("unknown stream")};const Is=c(e=>{async function*t(a,s={}){const r=await e.post("files/read",{signal:s.signal,searchParams:l({arg:a,count:s.length,...s}),headers:s.headers});yield*$s(r.body)}return t}),As=c(e=>{async function t(a,s={}){const r=await e.post("files/rm",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),n=await r.text();if(n!==""){const o=new la.HTTPError(r);throw o.message=n,o}}return t}),ze=c(e=>{async function t(a,s={}){const n=await(await e.post("files/stat",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json();return n.WithLocality=n.WithLocality||!1,js(ue(n))}return t});function js(e){return e.cid=m.parse(e.hash),delete e.hash,e}const Bs=c(e=>{async function t(a,s={}){await(await e.post("files/touch",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).text()}return t}),Us=c(e=>{async function t(a,s,r={}){const n=new AbortController,o=k(n.signal,r.signal);await(await e.post("files/write",{signal:o,searchParams:l({arg:a,streamChannels:!0,count:r.length,...r}),...await U([{content:s,path:"arg",mode:da(r.mode),mtime:ua(r.mtime)}],n,r.headers)})).text()}return t});function ks(e){return{chmod:Es(e),cp:Cs(e),flush:Ss(e),ls:Ns(e),mkdir:Rs(e),mv:Ts(e),read:Is(e),rm:As(e),stat:ze(e),touch:Bs(e),write:Us(e)}}const xs=c(e=>async(a,s,r={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),Ds=c(e=>{async function t(a,s={type:"Ed25519"}){const n=await(await e.post("key/gen",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json();return P(n)}return t}),Ls=c(e=>{async function t(a,s,r,n={}){const i=await(await e.post("key/import",{signal:n.signal,searchParams:l({arg:a,pem:s,password:r,...n}),headers:n.headers})).json();return P(i)}return t}),Fs=c(e=>async(a,s={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),Os=c(e=>{async function t(a={}){return((await(await e.post("key/list",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).Keys||[]).map(n=>P(n))}return t}),Ms=c(e=>{async function t(a,s,r={}){const n=await e.post("key/rename",{signal:r.signal,searchParams:l({arg:[a,s],...r}),headers:r.headers});return P(await n.json())}return t}),Hs=c(e=>{async function t(a,s={}){const n=await(await e.post("key/rm",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json();return P(n.Keys[0])}return t});function qs(e){return{export:xs(e),gen:Ds(e),import:Ls(e),info:Fs(e),list:Os(e),rename:Ms(e),rm:Hs(e)}}const Vs=c(e=>{async function t(a,s,r={}){const n=await e.post("log/level",{signal:r.signal,searchParams:l({arg:[a,s],...r}),headers:r.headers});return P(await n.json())}return t}),zs=c(e=>{async function t(a={}){return(await(await e.post("log/ls",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).Strings}return t}),Ks=c(e=>{async function*t(a={}){yield*(await e.post("log/tail",{signal:a.signal,searchParams:l(a),headers:a.headers})).ndjson()}return t});function Xs(e){return{level:Vs(e),ls:zs(e),tail:Ks(e)}}const Gs=c(e=>{async function t(a,s={}){const r=await e.post("name/publish",{signal:s.signal,searchParams:l({arg:`${a}`,...s}),headers:s.headers});return P(await r.json())}return t}),Ws=c(e=>{async function*t(a,s={}){const r=await e.post("name/resolve",{signal:s.signal,searchParams:l({arg:a,stream:!0,...s}),headers:s.headers});for await(const n of r.ndjson())yield n.Path}return t}),Ys=c(e=>{async function t(a,s={}){const r=await e.post("name/pubsub/cancel",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers});return P(await r.json())}return t}),Qs=c(e=>{async function t(a={}){const s=await e.post("name/pubsub/state",{signal:a.signal,searchParams:l(a),headers:a.headers});return P(await s.json())}return t}),Js=c(e=>{async function t(a={}){return(await(await e.post("name/pubsub/subs",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).Strings||[]}return t});function Zs(e){return{cancel:Ys(e),state:Qs(e),subs:Js(e)}}function er(e){return{publish:Gs(e),resolve:Ws(e),pubsub:Zs(e)}}const ar=c(e=>{async function t(a,s={}){const n=await(await e.post("object/data",{signal:s.signal,searchParams:l({arg:`${a instanceof Uint8Array?m.decode(a):a}`,...s}),headers:s.headers})).arrayBuffer();return new Uint8Array(n,0,n.byteLength)}return t}),tr=c(e=>{async function t(a,s={}){const n=await(await e.post("object/get",{signal:s.signal,searchParams:l({arg:`${a instanceof Uint8Array?m.decode(a):a}`,dataEncoding:"base64",...s}),headers:s.headers})).json();return{Data:te(n.Data,"base64pad"),Links:(n.Links||[]).map(o=>({Name:o.Name,Hash:m.parse(o.Hash),Tsize:o.Size}))}}return t}),sr=c(e=>{async function t(a,s={}){return((await(await e.post("object/links",{signal:s.signal,searchParams:l({arg:`${a instanceof Uint8Array?m.decode(a):a}`,...s}),headers:s.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:m.parse(o.Hash)}))}return t}),rr=c(e=>{async function t(a={}){const s=await e.post("object/new",{signal:a.signal,searchParams:l({arg:a.template,...a}),headers:a.headers}),{Hash:r}=await s.json();return m.parse(r)}return t}),nr=(e,t)=>c(s=>{const r=Ve(e,t);async function n(o,i={}){return r(o,{...i,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return n})(t),or=c(e=>{async function t(a,s={}){const n=await(await e.post("object/stat",{signal:s.signal,searchParams:l({arg:`${a}`,...s}),headers:s.headers})).json();return{...n,Hash:m.parse(n.Hash)}}return t}),cr=c(e=>{async function t(a,s,r={}){const n=await e.post("object/patch/add-link",{signal:r.signal,searchParams:l({arg:[`${a}`,s.Name||s.name||"",(s.Hash||s.cid||"").toString()||null],...r}),headers:r.headers}),{Hash:o}=await n.json();return m.parse(o)}return t}),ir=c(e=>{async function t(a,s,r={}){const n=new AbortController,o=k(n.signal,r.signal),i=await e.post("object/patch/append-data",{signal:o,searchParams:l({arg:`${a}`,...r}),...await U([s],n,r.headers)}),{Hash:u}=await i.json();return m.parse(u)}return t}),lr=c(e=>{async function t(a,s,r={}){const n=await e.post("object/patch/rm-link",{signal:r.signal,searchParams:l({arg:[`${a}`,s.Name||s.name||null],...r}),headers:r.headers}),{Hash:o}=await n.json();return m.parse(o)}return t}),dr=c(e=>{async function t(a,s,r={}){const n=new AbortController,o=k(n.signal,r.signal),i=await e.post("object/patch/set-data",{signal:o,searchParams:l({arg:[`${a}`],...r}),...await U([s],n,r.headers)}),{Hash:u}=await i.json();return m.parse(u)}return t});function ur(e){return{addLink:cr(e),appendData:ir(e),rmLink:lr(e),setData:dr(e)}}function hr(e,t){return{data:ar(t),get:tr(t),links:sr(t),new:rr(t),put:nr(e,t),stat:or(t),patch:ur(t)}}async function*Ke(e){if(e==null)throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=m.asCID(e);if(t){yield B({cid:t});return}if(e instanceof String||typeof e=="string"){yield B({path:e});return}if(e.cid!=null||e.path!=null)return yield B(e);if(Symbol.iterator in e){const a=e[Symbol.iterator](),s=a.next();if(s.done)return a;if(m.asCID(s.value)||s.value instanceof String||typeof s.value=="string"){yield B({cid:s.value});for(const r of a)yield B({cid:r});return}if(s.value.cid!=null||s.value.path!=null){yield B(s.value);for(const r of a)yield B(r);return}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const a=e[Symbol.asyncIterator](),s=await a.next();if(s.done)return a;if(m.asCID(s.value)||s.value instanceof String||typeof s.value=="string"){yield B({cid:s.value});for await(const r of a)yield B({cid:r});return}if(s.value.cid!=null||s.value.path!=null){yield B(s.value);for await(const r of a)yield B(r);return}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}function B(e){const t=e.cid||`${e.path}`;if(!t)throw w(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const a={path:t,recursive:e.recursive!==!1};return e.metadata!=null&&(a.metadata=e.metadata),a}const Xe=c(e=>{async function*t(a,s={}){for await(const{path:r,recursive:n,metadata:o}of Ke(a)){const i=await e.post("pin/add",{signal:s.signal,searchParams:l({...s,arg:r,recursive:n,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:s.headers});for await(const u of i.ndjson()){if(u.Pins){for(const h of u.Pins)yield m.parse(h);continue}yield m.parse(u)}}}return t});function fr(e){const t=Xe(e);return c(()=>{async function a(s,r={}){return re(t([{path:s,...r}],r))}return a})(e)}function Ce(e,t,a){const s={type:e,cid:m.parse(t)};return a&&(s.metadata=a),s}const mr=c(e=>{async function*t(a={}){let s=[];a.paths&&(s=Array.isArray(a.paths)?a.paths:[a.paths]);const r=await e.post("pin/ls",{signal:a.signal,searchParams:l({...a,arg:s.map(n=>`${n}`),stream:!0}),headers:a.headers});for await(const n of r.ndjson()){if(n.Keys){for(const o of Object.keys(n.Keys))yield Ce(n.Keys[o].Type,o,n.Keys[o].Metadata);return}yield Ce(n.Type,n.Cid,n.Metadata)}}return t}),Ge=c(e=>{async function*t(a,s={}){for await(const{path:r,recursive:n}of Ke(a)){const o=new URLSearchParams(s.searchParams);o.append("arg",`${r}`),n!=null&&o.set("recursive",String(n));const i=await e.post("pin/rm",{signal:s.signal,headers:s.headers,searchParams:l({...s,arg:`${r}`,recursive:n})});for await(const u of i.ndjson()){if(u.Pins){yield*u.Pins.map(h=>m.parse(h));continue}yield m.parse(u)}}}return t}),yr=e=>{const t=Ge(e);return c(()=>{async function a(s,r={}){return re(t([{path:s,...r}],r))}return a})(e)},We=({Name:e,Status:t,Cid:a})=>({cid:m.parse(a),name:e,status:t}),Ye=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},Qe=e=>{if(m.asCID(e))return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},me=({service:e,cid:t,name:a,status:s,all:r})=>{const n=l({service:Ye(e),name:a,force:r?!0:void 0});if(t)for(const o of t)n.append("cid",Qe(o));if(s)for(const o of s)n.append("status",o);return n},pr=({cid:e,service:t,background:a,name:s,origins:r})=>{const n=l({arg:Qe(e),service:Ye(t),name:s,background:a?!0:void 0});if(r)for(const o of r)n.append("origin",o.toString());return n};function gr(e){async function t(a,{timeout:s,signal:r,headers:n,...o}){const i=await e.post("pin/remote/add",{timeout:s,signal:r,headers:n,searchParams:pr({cid:a,...o})});return We(await i.json())}return t}function wr(e){async function*t({timeout:a,signal:s,headers:r,...n}){const o=await e.post("pin/remote/ls",{timeout:a,signal:s,headers:r,searchParams:me(n)});for await(const i of o.ndjson())yield We(i)}return t}function br(e){async function t({timeout:a,signal:s,headers:r,...n}){await e.post("pin/remote/rm",{timeout:a,signal:s,headers:r,searchParams:me({...n,all:!1})})}return t}function vr(e){async function t({timeout:a,signal:s,headers:r,...n}){await e.post("pin/remote/rm",{timeout:a,signal:s,headers:r,searchParams:me({...n,all:!0})})}return t}function _r(e){const t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}function Pr(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:Er(e.Stat)}}}function Er(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:a,Queued:s,Failed:r}=e.PinCount;return{status:"valid",pinCount:{queued:s,pinning:t,pinned:a,failed:r}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function Cr(e){async function t(a,s){const{endpoint:r,key:n,headers:o,timeout:i,signal:u}=s;await e.post("pin/remote/service/add",{timeout:i,signal:u,searchParams:l({arg:[a,_r(r),n]}),headers:o})}return t}function Sr(e){async function t(a={}){const{stat:s,headers:r,timeout:n,signal:o}=a,i=await e.post("pin/remote/service/ls",{timeout:n,signal:o,headers:r,searchParams:s===!0?l({stat:s}):void 0}),{RemoteServices:u}=await i.json();return u.map(Pr)}return t}function Nr(e){async function t(a,s={}){await e.post("pin/remote/service/rm",{signal:s.signal,headers:s.headers,searchParams:l({arg:a})})}return t}function Rr(e){const t=new je(e);return{add:Cr(t),ls:Sr(t),rm:Nr(t)}}function Tr(e){const t=new je(e);return{add:gr(t),ls:wr(t),rm:br(t),rmAll:vr(t),service:Rr(e)}}function $r(e){return{addAll:Xe(e),add:fr(e),ls:mr(e),rmAll:Ge(e),rm:yr(e),remote:Tr(e)}}const Ir=c(e=>{async function t(a={}){const{Strings:s}=await(await e.post("pubsub/ls",{signal:a.signal,searchParams:l(a),headers:a.headers})).json();return ha(s)||[]}return t}),Ar=c(e=>{async function t(a,s={}){const r=await e.post("pubsub/peers",{signal:s.signal,searchParams:l({arg:Be(a),...s}),headers:s.headers}),{Strings:n}=await r.json();return n||[]}return t}),jr=c(e=>{async function t(a,s,r={}){const n=l({arg:Be(a),...r}),o=new AbortController,i=k(o.signal,r.signal);await(await e.post("pubsub/pub",{signal:i,searchParams:n,...await U([s],o,r.headers)})).text()}return t}),Br=(e,t)=>{async function a(s,r){t.unsubscribe(s,r)}return a};class Ur{constructor(){this._subs=new Map}subscribe(t,a,s){const r=this._subs.get(t)||[];if(r.find(o=>o.handler===a))throw new Error(`Already subscribed to ${t} with this handler`);const n=new AbortController;return this._subs.set(t,[{handler:a,controller:n}].concat(r)),s&&s.addEventListener("abort",()=>this.unsubscribe(t,a)),n.signal}unsubscribe(t,a){const s=this._subs.get(t)||[];let r;a?(this._subs.set(t,s.filter(n=>n.handler!==a)),r=s.filter(n=>n.handler===a)):(this._subs.set(t,[]),r=s),(this._subs.get(t)||[]).length||this._subs.delete(t),r.forEach(n=>n.controller.abort())}}function kr(e){const t=new Ur;return{ls:Ir(e),peers:Ar(e),publish:jr(e),subscribe:fa(e,t),unsubscribe:Br(e,t)}}const xr=c(e=>{async function*t(a={}){yield*(await e.post("refs/local",{signal:a.signal,transform:P,searchParams:l(a),headers:a.headers})).ndjson()}return t}),Dr=c((e,t)=>Object.assign(async function*(s,r={}){const n=Array.isArray(s)?s:[s];yield*(await e.post("refs",{signal:r.signal,searchParams:l({arg:n.map(i=>`${i instanceof Uint8Array?m.decode(i):i}`),...r}),headers:r.headers,transform:P})).ndjson()},{local:xr(t)})),Lr=c(e=>{async function*t(a={}){yield*(await e.post("repo/gc",{signal:a.signal,searchParams:l(a),headers:a.headers,transform:r=>({err:r.Error?new Error(r.Error):null,cid:(r.Key||{})["/"]?m.parse(r.Key["/"]):null})})).ndjson()}return t}),Je=c(e=>{async function t(a={}){const r=await(await e.post("repo/stat",{signal:a.signal,searchParams:l(a),headers:a.headers})).json();return{numObjects:BigInt(r.NumObjects),repoSize:BigInt(r.RepoSize),repoPath:r.RepoPath,version:r.Version,storageMax:BigInt(r.StorageMax)}}return t}),Fr=c(e=>{async function t(a={}){return(await(await e.post("repo/version",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()).Version}return t});function Or(e){return{gc:Lr(e),stat:Je(e),version:Fr(e)}}const Mr=c(e=>{async function*t(a={}){yield*(await e.post("stats/bw",{signal:a.signal,searchParams:l(a),headers:a.headers,transform:r=>({totalIn:BigInt(r.TotalIn),totalOut:BigInt(r.TotalOut),rateIn:parseFloat(r.RateIn),rateOut:parseFloat(r.RateOut)})})).ndjson()}return t});function Hr(e){return{bitswap:Fe(e),repo:Je(e),bw:Mr(e)}}const qr=c(e=>{async function t(a={}){const s=await e.post("swarm/addrs",{signal:a.signal,searchParams:l(a),headers:a.headers}),{Addrs:r}=await s.json();return Object.keys(r).map(n=>({id:A(n),addrs:(r[n]||[]).map(o=>new I(o))}))}return t}),Vr=c(e=>{async function t(a,s={}){const r=await e.post("swarm/connect",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),{Strings:n}=await r.json();return n||[]}return t}),zr=c(e=>{async function t(a,s={}){const r=await e.post("swarm/disconnect",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),{Strings:n}=await r.json();return n||[]}return t}),Kr=c(e=>{async function t(a={}){const s=await e.post("swarm/addrs/local",{signal:a.signal,searchParams:l(a),headers:a.headers}),{Strings:r}=await s.json();return(r||[]).map(n=>new I(n))}return t}),Xr=c(e=>{async function t(a={}){const s=await e.post("swarm/peers",{signal:a.signal,searchParams:l(a),headers:a.headers}),{Peers:r}=await s.json();return(r||[]).map(n=>({addr:new I(n.Addr),peer:A(n.Peer),muxer:n.Muxer,latency:n.Latency,streams:n.Streams,direction:n.Direction==null?void 0:n.Direction===0?"inbound":"outbound"}))}return t});function Gr(e){return{addrs:qr(e),connect:Vr(e),disconnect:zr(e),localAddrs:Kr(e),peers:Xr(e)}}const Ze=c(e=>{async function*t(a,s={}){const r=new AbortController,n=k(r.signal,s.signal),{headers:o,body:i,total:u,parts:h}=await U(a,r,s.headers),[f,b]=typeof s.progress=="function"?Wr(u,h,s.progress):[void 0,void 0],S=await e.post("add",{searchParams:l({"stream-channels":!0,...s,progress:Boolean(f)}),onUploadProgress:b,signal:n,headers:o,body:i});for await(let p of S.ndjson())p=P(p),p.hash!==void 0?yield Qr(p):f&&f(p.bytes||0,p.name)}return t}),Wr=(e,t,a)=>t?[void 0,Yr(e,t,a)]:[a,void 0],Yr=(e,t,a)=>{let s=0;const r=t.length;return({loaded:n,total:o})=>{const i=Math.floor(n/o*e);for(;s<r;){const{start:u,end:h,name:f}=t[s];if(i<h){a(i-u,f);break}else a(h-u,f),s+=1}}};function Qr({name:e,hash:t,size:a,mode:s,mtime:r,mtimeNsecs:n}){const o={path:e,cid:m.parse(t),size:parseInt(a)};return s!=null&&(o.mode=parseInt(s,8)),r!=null&&(o.mtime={secs:r,nsecs:n||0}),o}const Se=W;function Jr(e){return typeof e.stream=="function"?Se(e.stream()):Se(new Response(e).body)}var Zr=Jr;async function*Y(e){yield e}async function en(e){if(F(e))return Y(ie(e));if(typeof e=="string"||e instanceof String)return Y(ie(e.toString()));if(X(e))return Zr(e);if(G(e)&&(e=W(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=se(e),{value:a,done:s}=await t.peek();if(s)return Y(new Uint8Array(0));if(t.push(a),Number.isInteger(a))return Y(Uint8Array.from(await Me(t)));if(F(a)||typeof a=="string"||a instanceof String)return de(t,ie)}throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function ie(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):te(e.toString())}async function*an(e,t){if(e==null)throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield Q(e.toString(),t);return}if(F(e)||X(e)){yield Q(e,t);return}if(G(e)&&(e=W(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const a=se(e),{value:s,done:r}=await a.peek();if(r){yield{content:[]};return}if(a.push(s),Number.isInteger(s)||F(s)||typeof s=="string"||s instanceof String){yield Q(a,t);return}throw w(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(le(e)){yield Q(e,t);return}throw w(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function Q(e,t){const{path:a,mode:s,mtime:r,content:n}=e,o={path:a||"",mode:He(s),mtime:qe(r)};return n?o.content=await t(n):a||(o.content=await t(e)),o}function tn(e){return an(e,en)}function sn(e){const t=Ze(e);return c(()=>{async function a(s,r={}){return await re(t(tn(s),r))}return a})(e)}const rn=c(e=>{async function*t(a,s={}){yield*(await e.post("cat",{signal:s.signal,searchParams:l({arg:a.toString(),...s}),headers:s.headers})).iterator()}return t}),nn=c(e=>async(a={})=>(await e.post("commands",{signal:a.signal,searchParams:l(a),headers:a.headers})).json()),on=c(e=>async(a,s={})=>(await(await e.post("dns",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers})).json()).Path),cn=c(e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}),ln=c(e=>{async function*t(a,s={}){const r={arg:`${a instanceof Uint8Array?m.decode(a):a}`,...s};r.compressionLevel&&(r["compression-level"]=r.compressionLevel,delete r.compressionLevel),yield*(await e.post("get",{signal:s.signal,searchParams:l(r),headers:s.headers})).iterator()}return t}),ea=c(e=>{async function t(a={}){const r=await(await e.post("id",{signal:a.signal,searchParams:l({arg:a.peerId?a.peerId.toString():void 0,...a}),headers:a.headers})).json(),n={...P(r)};return n.id=A(n.id),n.addresses&&(n.addresses=n.addresses.map(o=>new I(o))),n}return t}),dn=e=>{const t=ea(e);async function a(s={}){const r=await t(s);return Boolean(r&&r.addresses&&r.addresses.length)}return a},un=c((e,t)=>{async function*a(s,r={}){const n=`${s instanceof Uint8Array?m.decode(s):s}`;async function o(u){let h=u.Hash;if(h.includes("/")){const b=h.startsWith("/ipfs/")?h:`/ipfs/${h}`;h=(await ze(t)(b)).cid}else h=m.parse(h);const f={name:u.Name,path:n+(u.Name?`/${u.Name}`:""),size:u.Size,cid:h,type:hn(u)};return u.Mode&&(f.mode=parseInt(u.Mode,8)),u.Mtime!==void 0&&u.Mtime!==null&&(f.mtime={secs:u.Mtime},u.MtimeNsecs!==void 0&&u.MtimeNsecs!==null&&(f.mtime.nsecs=u.MtimeNsecs)),f}const i=await e.post("ls",{signal:r.signal,searchParams:l({arg:n,...r}),headers:r.headers});for await(let u of i.ndjson()){if(u=u.Objects,!u)throw new Error("expected .Objects in results");if(u=u[0],!u)throw new Error("expected one array in results.Objects");const h=u.Links;if(!Array.isArray(h))throw new Error("expected one array in results.Objects[0].Links");if(!h.length){yield o(u);return}yield*h.map(o)}}return a});function hn(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const fn=c(e=>{async function t(a={}){const s=await e.post("dns",{signal:a.signal,searchParams:l(a),headers:a.headers});return P(await s.json())}return t}),mn=c(e=>{async function*t(a,s={}){yield*(await e.post("ping",{signal:s.signal,searchParams:l({arg:`${a}`,...s}),headers:s.headers,transform:P})).ndjson()}return t}),yn=c(e=>{async function t(a,s={}){const r=await e.post("resolve",{signal:s.signal,searchParams:l({arg:a,...s}),headers:s.headers}),{Path:n}=await r.json();return n}return t}),pn=c(e=>async(a={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),gn=c(e=>{async function t(a={}){await(await e.post("shutdown",{signal:a.signal,searchParams:l(a),headers:a.headers})).text()}return t}),wn=c(e=>{async function t(a={}){const s=await e.post("version",{signal:a.signal,searchParams:l(a),headers:a.headers});return{...P(await s.json()),"ipfs-http-client":"1.0.0"}}return t});function bn(e={}){const t={name:pe.name,code:pe.code,encode:h=>h,decode:h=>h},a=Object.values(ma);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(h=>a.push(h));const s=new ot({bases:a,loadBase:e.ipld&&e.ipld.loadBase}),r=Object.values(ya);[yt,pa,ga,wa,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(h=>r.push(h));const n=new it({codecs:r,loadCodec:e.ipld&&e.ipld.loadCodec}),o=Object.values(ba);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(h=>o.push(h));const i=new dt({hashers:o,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:sn(e),addAll:Ze(e),bitswap:vt(e),block:Ut(e),bootstrap:Ot(e),cat:rn(e),commands:nn(e),config:Wt(e),dag:ss(n,e),dht:ws(e),diag:Ps(e),dns:on(e),files:ks(e),get:ln(e),getEndpointConfig:cn(e),id:ea(e),isOnline:dn(e),key:qs(e),log:Xs(e),ls:un(e),mount:fn(e),name:er(e),object:hr(n,e),pin:$r(e),ping:mn(e),pubsub:kr(e),refs:Dr(e),repo:Or(e),resolve:yn(e),start:pn(e),stats:Hr(e),stop:gn(e),swarm:Gr(e),version:wn(e),bases:s,codecs:n,hashers:i}}const vn={fileUrl:null,name:null,description:null,properties:[],collection:null,approveRights:!1,agreenTerms:!1},_n={key:0},Pn=d("div",{class:"pb-5 text-center"},[d("h2",null,"Create NFTs"),d("p",{class:"lead fw-lighter"},"NFTs can represent essentially any type of digital file, with artists creating NFTs featuring pictures, videos, gifs, audio files, and mixtures of them all. There are also utility NFT tokens, which provide a good or service and contain inherent value coded within them, what's your vision?")],-1),En={class:"row g-5"},Cn={class:"col"},Sn={class:"row g-3"},Nn={class:"col-12"},Rn=d("label",{for:"uploadFile",class:"form-label"},"Upload File",-1),Tn=d("p",{class:"fw-lighter"},"Add your unique image / video / audio file",-1),$n={key:0,class:"text-center"},In=["src"],An=d("div",{class:"invalid-feedback"}," You must upload a file ",-1),jn={class:"col-12"},Bn=d("label",{for:"name",class:"form-label"},"Name",-1),Un=d("p",{class:"fw-lighter"},"Choose a unique name for your NFT",-1),kn=d("div",{class:"invalid-feedback"}," You must choose a name ",-1),xn={class:"col-12"},Dn=d("label",{for:"description",class:"form-label"},"Description",-1),Ln=d("p",{class:"fw-lighter"},"Describe your NFT, help other users understand what's unique about it",-1),Fn={class:"col-12"},On=d("label",{for:"properties",class:"form-label"},"Properties",-1),Mn=d("p",{class:"fw-lighter"},"List attributes that represents your NFT (color, shape, mood, etc..)",-1),Hn={class:"col-6"},qn=["id","onInput","value"],Vn={class:"col-6"},zn=["id","onInput","value"],Kn={class:"col-12"},Xn={for:"collection",class:"form-label"},Gn=fe(" Collection "),Wn=d("p",{class:"fw-lighter"},"The collection where your NFT will appear.",-1),Yn={class:"input-group has-validation"},Qn=["value"],Jn=d("i",{class:"bi bi-arrow-repeat"},null,-1),Zn=[Jn],eo=d("div",{class:"invalid-feedback"}," You must choose / create a collection ",-1),ao=d("hr",{class:"my-4"},null,-1),to=d("p",{class:"fw-semibold fst-italic"},"Note, the process of minting an NFT is an irreversible process, make sure all the above details are right.",-1),so={class:"form-check"},ro=d("label",{class:"form-check-label fw-lighter",for:"approveRights"},"I approve that I'm the owner or have the rights of publication and sale.",-1),no={class:"form-check"},oo=d("label",{class:"form-check-label fw-lighter",for:"agreenTerms"},"I approve NFTrade's Terms & Conditions",-1),co=d("hr",{class:"my-4"},null,-1),io=["disabled"],lo={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},uo={key:1,class:"w-100 btn btn-primary btn-lg",type:"button",disabled:""},ho={key:1},fo={class:"pb-5 text-center"},mo=he({__name:"create",setup(e){const t="https://ipfs.infura.io/ipfs/QmUC4RmLypFruXTFNn51ZuqAmt4BFzLEpm8n3Wjg3sLP1a",a=bn({url:be+Ca+"/api/v0"}),{account:s,library:r,chainId:n}=Ne();va();const{$compare:o}=_a(),i=xe(),u=De(),h=Le(),f=vn;Re([s,r,h],()=>{!!r.value&&!!s.value&&(ne(),E())});const b=O(null),S=O("0"),p=O(!1),v=O(!1);async function E(){const N=H[n.value],g=new r.value.eth.Contract(K,N);b.value=await g.methods.newNFTFeeToken().call(),S.value=await g.methods.newNFTFeeAmount().call();const _=new r.value.eth.Contract(ve,b.value),j=await _.methods.balanceOf(s.value).call();M.exports.greaterThanOrEqual(M.exports.BigInt(j),M.exports.BigInt(S.value))?p.value=!0:p.value=!1;const L=await _.methods.allowance(s.value,N).call();M.exports.greaterThanOrEqual(M.exports.BigInt(L),M.exports.BigInt(S.value))?v.value=!0:v.value=!1}const x=O([]);function ne(){const N=new r.value.eth.Contract(K,H[n.value]);x.value=[],N.methods.getCollectionTokenList().call({from:s.value}).then(async g=>{if(g.length>0){const _=g.map(async j=>{const L=await N.methods.collectionMap(j).call();L.owner===s.value&&x.value.push(L)});await Promise.all(_),x.value.length>0&&(x.value.sort(o("createTime")),f.collection=x.value[0].token)}})}async function aa(N){i.value=!0;const g=N.target.files[0];try{const _=await a.add(g,{progress:L=>console.log(`received: ${L}`)}),j=`${be}${Sa}/${_.path}`;f.fileUrl=j,i.value=!1}catch(_){console.log("Error uploading file: ",_),f.fileUrl=null,i.value=!1}}const R=Pa("propertiesList",()=>[{property:null,value:null}]);function ye(N,g,_){if(g==="property"?R.value[_].property=N.target.value:g==="value"&&(R.value[_].value=N.target.value),R.value[_].property&&R.value[_].value&&(R.value[_+1]||R.value.push({property:null,value:null})),!R.value[_].property||!R.value[_].value){const j=R.value.length;j>_+1&&!R.value[j-1].property&&!R.value[j-1].value&&R.value.pop()}}async function ta(){if(i.value=!0,!!s.value&&!!n.value&&f.collection)try{v.value||(await new r.value.eth.Contract(ve,b.value).methods.approve(H[n.value],S.value).send({from:s.value}),v.value=!0),await new r.value.eth.Contract(K,H[n.value]).methods.newNFT(f.collection,s.value,t).send({from:s.value}),E(),i.value=!1}catch(N){console.info(N),i.value=!1}else i.value=!1}return Te(()=>{!!r.value&&!!s.value&&!!n.value&&(ne(),E())}),(N,g)=>{const _=rt,j=ke,L=Na;return y(s)?(T(),$("div",_n,[Pn,d("div",En,[d("div",Cn,[d("form",{class:$e(`needs-validation ${y(u)?"was-validated":""}`),novalidate:""},[d("div",Sn,[d("div",Nn,[Rn,Tn,d("input",{class:"form-control",type:"file",id:"uploadFile",onChange:aa,required:""},null,32),y(f).fileUrl?(T(),$("div",$n,[d("img",{src:y(f).fileUrl,class:"rounded",alt:""},null,8,In)])):J("",!0),An]),d("div",jn,[Bn,Un,D(d("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter the NFT's name","onUpdate:modelValue":g[0]||(g[0]=C=>y(f).name=C),required:""},null,512),[[Z,y(f).name]]),kn]),d("div",xn,[Dn,Ln,D(d("textarea",{class:"form-control",id:"description",rows:"3",placeholder:"Enter the NFT's description","onUpdate:modelValue":g[1]||(g[1]=C=>y(f).description=C)},null,512),[[Z,y(f).description]])]),d("div",Fn,[On,Mn,(T(!0),$(ge,null,we(y(R),(C,V)=>(T(),$("div",{class:"row my-3",key:V},[d("div",Hn,[d("input",{type:"text",class:"form-control",id:`property-${V}`,placeholder:"Property",onInput:oe=>ye(oe,"property",V),value:C.property},null,40,qn)]),d("div",Vn,[d("input",{type:"text",class:"form-control",id:`value-${V}`,placeholder:"Value",onInput:oe=>ye(oe,"value",V),value:C.value},null,40,zn)])]))),128))]),d("div",Kn,[d("label",Xn,[Gn,z(j,null,{default:Ue(()=>[z(_)]),_:1})]),Wn,d("div",Yn,[D(d("select",{class:"form-select",id:"collection","onUpdate:modelValue":g[2]||(g[2]=C=>y(f).collection=C),"aria-label":"Select a Collection",placeholder:"Select a Collection",required:""},[(T(!0),$(ge,null,we(x.value,C=>(T(),$("option",{key:C.token,value:C.token},ee(C.name),9,Qn))),128))],512),[[Ea,y(f).collection]]),d("button",{class:"btn btn-outline-secondary",type:"button",onClick:ne},Zn),eo])])]),ao,to,d("div",so,[D(d("input",{type:"checkbox",class:"form-check-input",id:"approveRights","onUpdate:modelValue":g[3]||(g[3]=C=>y(f).approveRights=C),required:""},null,512),[[ae,y(f).approveRights]]),ro]),d("div",no,[D(d("input",{type:"checkbox",class:"form-check-input",id:"agreenTerms","onUpdate:modelValue":g[4]||(g[4]=C=>y(f).agreenTerms=C),required:""},null,512),[[ae,y(f).agreenTerms]]),oo]),co,p.value?(T(),$("button",{key:0,class:"w-100 btn btn-primary btn-lg",type:"button",disabled:y(i),onClick:ta},[y(i)?(T(),$("span",lo)):J("",!0),fe(" "+ee(y(i)?"Loading...":"Create"),1)],8,io)):p.value?J("",!0):(T(),$("button",uo," Insufficient Balance "))],2)])])])):(T(),$("div",ho,[d("div",fo,[z(L)])]))}}}),yo={class:"container py-5"},Po=he({__name:"index",setup(e){return(t,a)=>{const s=mo,r=ke;return T(),$("main",null,[d("div",yo,[z(r,null,{default:Ue(()=>[z(s)]),_:1})])])}}});export{Po as default};
