import{_ as V,d as D,u as F,w as E,r as g,b as U,e as P,o as i,c as r,a as t,F as G,f as z,n as R,g as M,t as u,h as k,i as N,j as Q,p as W,k as H,l as J,m as K,q as X,v as Y}from"./entry-f37e1690.mjs";import{u as Z}from"./asyncData-3edde299.mjs";import{u as O,a as ee,b as te}from"./useSubmit-6e9d3c62.mjs";import{u as q}from"./useWeb3-0193a35d.mjs";import{M as y,a as C}from"./Market_abi-93ee176c.mjs";const ae=D({__name:"collection",setup(v,{expose:h}){h();const{$compare:c,$clip:e}=F(),o=O(),n=ee(),{account:s,library:a,chainId:l}=q();E([s,a,l,n],()=>{!!a.value&&!!s.value&&!!l.value&&A()});const b=g("");function p(m,f){b.value=m,e(m,f)}const w=U(),_=g([]);function A(){_.value=[],o.value=!0;const m=new a.value.eth.Contract(y,C[l.value]);m.methods.getCollectionTokenList().call({from:s.value}).then(async f=>{if(f.length>0){const T=f.map(async I=>{const L=await m.methods.collectionMap(I).call(),{data:j}=await Z(L.token,()=>$fetch(L.tokenURI)),B={...L,metadata:j.value};_.value.push(B)});await Promise.all(T),_.value.length>0&&_.value.sort(c("createTime"))}o.value=!1})}P(()=>{A()});function x(m,f){o.value=!0,new a.value.eth.Contract(y,C[l.value]).methods.auditCollection(m,f).send({from:s.value}).then(()=>{n.value=Date.parse(new Date().toString()),o.value=!1}).catch(I=>{console.info(I),o.value=!1})}function $(m,f){o.value=!0,new a.value.eth.Contract(y,C[l.value]).methods.showCollection(m,f).send({from:s.value}).then(()=>{n.value=Date.parse(new Date().toString()),o.value=!1}).catch(I=>{console.info(I),o.value=!1})}const d={$compare:c,$clip:e,loading:o,timestamp:n,account:s,library:a,chainId:l,selectedAddress:b,copyAddress:p,isCopy:w,collectionList:_,getCollectionList:A,audit:x,show:$};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),S=v=>(W("data-v-418b75ef"),v=v(),H(),v),oe={class:"py-3 bg-light"},se={key:0,class:"container"},ne={class:"row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4"},le={class:"card shadow-sm position-relative"},ce=S(()=>t("span",{class:"visually-hidden"},"Is Show",-1)),ie=[ce],re=S(()=>t("img",{src:K,class:"card-img-top"},null,-1)),de={class:"card-body"},ue={class:"card-title"},_e={key:0,class:"bi bi-patch-check-fill text-primary"},ve={class:"card-text"},he={class:"list-group list-group-flush"},pe={class:"list-group-item"},be=M(" Token: "),me=["onClick"],fe={class:"list-group-item"},ge={class:"list-group-item"},ye={class:"list-group-item"},Ce={class:"card-body"},ke={class:"btn-group"},we=["onClick"],Ae=["onClick"],Ie={key:1,class:"container"},Me={class:"row py-lg-5"},$e={class:"col-lg-6 col-md-8 mx-auto"},Re=S(()=>t("p",{class:"lead text-muted"},"No NFTs to show here..",-1)),Se=S(()=>t("button",{type:"button",class:"btn btn-primary"}," Create ",-1));function xe(v,h,c,e,o,n){const s=J;return i(),r("div",oe,[e.collectionList.length>0?(i(),r("div",se,[t("div",ne,[(i(!0),r(G,null,z(e.collectionList,a=>(i(),r("div",{class:"col",key:a.token},[t("div",le,[t("span",{class:R(`position-absolute top-0 start-100 translate-middle p-2 border border-light rounded-circle ${a.show?"bg-success":"bg-danger"}`)},ie,2),re,t("div",de,[t("h5",ue,[M(u(a.symbol)+" - "+u(a.name)+" ",1),a.approve?(i(),r("i",_e)):k("",!0)]),t("p",ve,u(a.metadata.description),1)]),t("ul",he,[t("li",pe,[be,t("a",{class:R(`card-link ${e.isCopy&&a.token===e.selectedAddress?"text-success":""}`),onClick:l=>e.copyAddress(a.token,l)},[M(u(a.token)+" ",1),t("i",{class:R(`bi ${e.isCopy&&a.token===e.selectedAddress?"bi-clipboard2-check":"bi-clipboard2"}`)},null,2)],10,me)]),t("li",fe,"Owner: "+u(a.owner),1),t("li",ge,"Royalty: "+u(a.royalty)+" %",1),t("li",ye,"Create Time: "+u(v.$parseTime(a.createTime)),1)]),t("div",Ce,[t("div",ke,[t("button",{type:"button",class:"btn btn-sm btn-primary",onClick:l=>e.audit(a.token,!a.approve)},u(a.approve?"Audit Cancel":"Audit Pass"),9,we),t("button",{type:"button",class:"btn btn-sm btn-outline-primary",onClick:l=>e.show(a.token,!a.show)},u(a.show?"Show Cancel":"Show Pass"),9,Ae)])])])]))),128))])])):(i(),r("div",Ie,[t("div",Me,[t("div",$e,[Re,t("p",null,[N(s,{to:"/create"},{default:Q(()=>[Se]),_:1})])])])]))])}var Te=V(ae,[["render",xe],["__scopeId","data-v-418b75ef"]]);const Le=D({__name:"staff",setup(v,{expose:h}){h();const c=O(),e=te(),o=g(null),n=g(!1),{account:s,library:a,chainId:l}=q();E([s,a,l],()=>{!!a.value&&!!s.value&&!!l.value&&p()});const b=g("");async function p(){c.value=!0;const d=new a.value.eth.Contract(y,C[l.value]);b.value=await d.methods.MANAGER_ROLE().call(),c.value=!1}P(()=>{p()});function w(){if(!o.value)n.value=!1;else try{o.value=a.value.utils.toChecksumAddress(o.value),n.value=!1}catch{n.value=!0}}const _=g(!1);async function A(){e.value=!0,c.value=!0;try{const d=new a.value.eth.Contract(y,C[l.value]);_.value=await d.methods.hasRole(b.value,a.value.utils.toChecksumAddress(o.value)).call()}catch{n.value=!0,setTimeout(()=>{n.value=!1},3e3)}e.value=!1,c.value=!1}async function x(){e.value=!0,c.value=!0;try{const d=new a.value.eth.Contract(y,C[l.value]);_.value?await d.methods.removeManager(a.value.utils.toChecksumAddress(o.value)).send({from:s.value}):await d.methods.addManager(a.value.utils.toChecksumAddress(o.value)).send({from:s.value})}catch{n.value=!0,setTimeout(()=>{n.value=!1},3e3)}e.value=!1,c.value=!1}const $={loading:c,isSubmit:e,formAccount:o,accountIsValid:n,account:s,library:a,chainId:l,roleManageValue:b,getCollectionRole:p,checkAddress:w,CollectionIsManage:_,query:A,approve:x};return Object.defineProperty($,"__isScriptSetup",{enumerable:!1,value:!0}),$}}),Ne={class:"py-3"},Ve={class:"container"},De=t("h4",null,"Staff Manage",-1),Ee={key:0,class:"alert alert-danger fade show",role:"alert"},Oe={class:"mb-3"},qe=t("label",{for:"account",class:"form-label"},"Account",-1),Pe=t("div",{class:"invalid-feedback"}," Required Account Address ",-1),je={class:"mb-3"},Be={for:"account",class:"form-label"},Fe={class:"mb-3"},Ue=["disabled"],Ge={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ze=["disabled"],Qe={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function We(v,h,c,e,o,n){return i(),r("div",Ne,[t("div",Ve,[De,e.accountIsValid?(i(),r("div",Ee," Address is invalid!!! ")):k("",!0),t("form",{class:R(`needs-validation ${e.isSubmit?"was-validated":""}`),novalidate:""},[t("div",Oe,[qe,X(t("input",{class:"form-control",id:"account","onUpdate:modelValue":h[0]||(h[0]=s=>e.formAccount=s),placeholder:"Required Account Address",onInput:e.checkAddress,required:""},null,544),[[Y,e.formAccount]]),Pe]),t("div",je,[t("label",Be,"Result: "+u(e.CollectionIsManage),1)]),t("div",Fe,[t("button",{class:"btn btn-primary",type:"button",disabled:!e.formAccount||e.loading||e.accountIsValid,onClick:e.query},[e.loading?(i(),r("span",Ge)):k("",!0),M(" "+u(e.loading?"Loading...":"Query"),1)],8,Ue),t("button",{class:"btn btn-danger ms-3",type:"button",disabled:!e.formAccount||e.loading||e.accountIsValid,onClick:e.approve},[e.loading?(i(),r("span",Qe)):k("",!0),M(" "+u(e.loading?"Loading...":e.CollectionIsManage?"Remove":"Approve"),1)],8,ze)])],2)])])}var He=V(Le,[["render",We]]);const Je=D({__name:"manage",setup(v,{expose:h}){h();const c=O(),{account:e,library:o,chainId:n}=q();E([e,o],()=>{!!o.value&&!!e.value&&!!n.value&&l()});const s=g(!1),a=g(!1);async function l(){c.value=!0;const p=new o.value.eth.Contract(y,C[n.value]),w=await p.methods.DEFAULT_ADMIN_ROLE().call(),_=await p.methods.MANAGER_ROLE().call();s.value=await p.methods.hasRole(w,e.value).call(),a.value=await p.methods.hasRole(_,e.value).call(),c.value=!1}const b={loading:c,account:e,library:o,chainId:n,CollectionIsAdmin:s,CollectionIsManage:a,getCollectionRole:l};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),Ke={key:0,class:"container py-5"},Xe={class:"nav nav-tabs",id:"manageTab",role:"tablist"},Ye=t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active",id:"collection-tab","data-bs-toggle":"tab","data-bs-target":"#collection-tab-pane",type:"button",role:"tab","aria-controls":"collection-tab-pane","aria-selected":"true"}," Collection Manage ")],-1),Ze={key:0,class:"nav-item",role:"presentation"},et=t("button",{class:"nav-link",id:"staff-tab","data-bs-toggle":"tab","data-bs-target":"#staff-tab-pane",type:"button",role:"tab","aria-controls":"staff-tab-pane","aria-selected":"false"}," Market Manage ",-1),tt=[et],at={class:"tab-content",id:"manageTabContent"},ot={class:"tab-pane fade show active",id:"collection-tab-pane",role:"tabpanel","aria-labelledby":"collection-tab",tabindex:"0"},st={key:0,class:"tab-pane fade",id:"staff-tab-pane",role:"tabpanel","aria-labelledby":"staff-tab",tabindex:"0"},nt={key:1,class:"container py-5"},lt=t("h1",null,"No permission",-1),ct=[lt];function it(v,h,c,e,o,n){const s=Te,a=He;return i(),r("main",null,[e.CollectionIsManage?(i(),r("div",Ke,[t("ul",Xe,[Ye,e.CollectionIsAdmin?(i(),r("li",Ze,tt)):k("",!0)]),t("div",at,[t("div",ot,[N(s)]),e.CollectionIsAdmin?(i(),r("div",st,[N(a)])):k("",!0)])])):(i(),r("div",nt,ct))])}var ht=V(Je,[["render",it]]);export{ht as default};
