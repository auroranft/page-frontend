import{u as Ne}from"./useWeb3-0193a35d.mjs";import{_ as ue,d as he,w as Te,r as M,e as Ae,o as S,c as N,a as h,n as Ie,q as x,v as J,t as Z,I as ee,h as Q,g as fe,R as $e,S as ca,T as ia,V as f,W as la,X as da,Y as ua,Z as c,$ as i,a0 as $,a1 as w,a2 as ha,a3 as T,a4 as ae,a5 as je,a6 as fa,a7 as ma,a8 as ya,a9 as Be,aa as ga,ab as Ue,ac as pa,ad as pe,ae as wa,af as ba,ag as _a,ah as va,ai as Pa,aj as Ea,ak as Ca,u as Ra,N as O,s as Sa,F as we,f as be,i as z,j as ke,al as Na,K as xe}from"./entry-f37e1690.mjs";import{u as De,b as Le,a as Me}from"./useSubmit-6e9d3c62.mjs";import{M as H,a as B,i as ne,b as Ta,c as _e}from"./Market_abi-93ee176c.mjs";import{_ as Aa}from"./ConnectBtn-489c8ac1.mjs";import{T as Ia}from"./TokenERC721_abi-821b0436.mjs";import{T as ve}from"./TokenERC20_abi-e6f25529.mjs";const $a={name:null,symbol:null,royalty:0,verifyRights:!1,agreenTerms:!1},ja=he({__name:"addCollection",setup(e,{expose:t}){t();const{account:r,library:a,chainId:s}=Ne();Te([r,a,s],()=>{!!r.value&&!!a.value&&!!s.value&&y()});const n=De(),o=Le(),d=Me(),l=$a;function u(){o.value=!0,n.value=!0,l.royalty=m.value,l.name&&l.symbol&&l.verifyRights&&l.agreenTerms?new a.value.eth.Contract(H,B[s.value]).methods.addCollection(l.name,l.symbol,l.royalty).send({from:r.value}).on("error",function(){n.value=!1,document.getElementById("closeModalAddCollection").click()}).then(()=>{d.value=Date.parse(new Date().toString()),n.value=!1,document.getElementById("closeModalAddCollection").click()}):n.value=!1}const m=M(0),g=M(0);async function y(){const R=new a.value.eth.Contract(H,B[s.value]);g.value=await R.methods.maxRoyaltyRate().call({from:r.value})}function p(R){m.value=R.target.value}Ae(()=>{y()});const C={account:r,library:a,chainId:s,loading:n,isSubmit:o,timestamp:d,formModel:l,createCollection:u,currentRoyaltyRate:m,maxRoyaltyRate:g,getBaseInfo:y,changeRoyalty:p};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),Ba={style:{display:"inline-block"}},Ua=h("button",{type:"button",class:"btn btn-outline-primary",style:{"--bs-btn-padding-y":".25rem","--bs-btn-padding-x":".5rem","--bs-btn-font-size":".75rem"},"data-bs-toggle":"modal","data-bs-target":"#modalAddCollection"},[h("i",{class:"bi bi-plus"})],-1),ka={class:"modal fade",id:"modalAddCollection",tabindex:"-1","aria-labelledby":"modalAddCollectionLabel","aria-hidden":"true"},xa={class:"modal-dialog modal-lg modal-dialog-centered"},Da={class:"modal-content"},La=h("div",{class:"modal-header"},[h("h5",{class:"modal-title",id:"modalAddCollectionLabel"},"Create New Collection"),h("button",{id:"closeModalAddCollection",type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ma={class:"modal-body"},Fa={class:"row g-5"},Oa={class:"col"},Ha=h("p",{class:"fw-lighter"},"When creating a new collection, you are deploying your own contract to the blockchain! NFTrade charges zero platform transaction fees, so you only need to pay for the network gas fees. This is a collection under your own unique contract, meaning you are the owner of the contract and you'll be able to add as many NFTs to that collection as you'd like. Your minted tokens will receive incremental IDs starting from 1, increasing with each new NFT in the collection.",-1),qa=h("p",{class:"fw-lighter"},"Since this is a unique contract address, you will have the opportunity to verify your collection later on.",-1),Va={class:"my-4"},za=h("label",{for:"name",class:"form-label"},"Name",-1),Ka=h("p",{class:"fw-lighter"},"Crypto Punks / Meebits / etc..",-1),Xa=h("div",{class:"invalid-feedback"}," You must choose a name ",-1),Ga={class:"my-4"},Wa=h("label",{for:"symbol",class:"form-label"},"Symbol",-1),Ya=h("p",{class:"fw-lighter"},"CPNKS / MBTS / etc..",-1),Qa=h("div",{class:"invalid-feedback"}," You must choose a symbol ",-1),Ja={class:"my-4"},Za={for:"royaltyRate",class:"form-label"},et=["max","value"],at=h("div",{class:"my-4"},null,-1),tt={class:"form-check"},rt=h("label",{class:"form-check-label fw-lighter",for:"verifyRights"},"I verify I am minting a unique collection and that this is not a reproduction, stolen intellectual property, or a scam.",-1),st={class:"form-check"},nt=h("label",{class:"form-check-label fw-lighter",for:"agreenTerms"},"I approve NFTrade's Terms & Conditions",-1),ot=h("hr",{class:"my-4"},null,-1),ct=["disabled"],it={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function lt(e,t,r,a,s,n){return S(),N("div",Ba,[Ua,h("div",ka,[h("div",xa,[h("div",Da,[La,h("div",Ma,[h("div",Fa,[h("div",Oa,[Ha,qa,h("form",{class:Ie(`needs-validation ${a.isSubmit?"was-validated":""}`),novalidate:""},[h("div",Va,[za,Ka,x(h("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter the collection's name","onUpdate:modelValue":t[0]||(t[0]=o=>a.formModel.name=o),required:""},null,512),[[J,a.formModel.name]]),Xa]),h("div",Ga,[Wa,Ya,x(h("input",{type:"text",class:"form-control",id:"symbol",placeholder:"Enter the collection's symbol","onUpdate:modelValue":t[1]||(t[1]=o=>a.formModel.symbol=o),required:""},null,512),[[J,a.formModel.symbol]]),Qa]),h("div",Ja,[h("label",Za,"RoyaltyRate: "+Z(a.currentRoyaltyRate)+" %",1),h("input",{type:"range",class:"form-range",min:"0",max:a.maxRoyaltyRate,step:"1",id:"royaltyRate",value:a.currentRoyaltyRate,onChange:a.changeRoyalty,required:""},null,40,et)]),at,h("div",tt,[x(h("input",{type:"checkbox",class:"form-check-input",id:"verifyRights","onUpdate:modelValue":t[2]||(t[2]=o=>a.formModel.verifyRights=o),required:""},null,512),[[ee,a.formModel.verifyRights]]),rt]),h("div",st,[x(h("input",{type:"checkbox",class:"form-check-input",id:"agreenTerms","onUpdate:modelValue":t[3]||(t[3]=o=>a.formModel.agreenTerms=o),required:""},null,512),[[ee,a.formModel.agreenTerms]]),nt]),ot,h("button",{class:"w-100 btn btn-primary btn-lg",type:"button",disabled:a.loading,onClick:a.createCollection},[a.loading?(S(),N("span",it)):Q("",!0),fe(" "+Z(a.loading?"Loading...":"Create Collection"),1)],8,ct)],2)])])])])])])])}var dt=ue(ja,[["render",lt]]);const ut=e=>Promise.reject(new Error(`No base found for "${e}"`));class ht{constructor(t){this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase||ut;for(const r of t.bases)this.addBase(r)}addBase(t){if(this._basesByName[t.name]||this._basesByPrefix[t.prefix])throw new Error(`Codec already exists for codec "${t.name}"`);this._basesByName[t.name]=t,this._basesByPrefix[t.prefix]=t}removeBase(t){delete this._basesByName[t.name],delete this._basesByPrefix[t.prefix]}async getBase(t){if(this._basesByName[t])return this._basesByName[t];if(this._basesByPrefix[t])return this._basesByPrefix[t];const r=await this._loadBase(t);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}}const ft=e=>Promise.reject(new Error(`No codec found for "${e}"`));class mt{constructor(t){this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec||ft;for(const r of t.codecs)this.addCodec(r)}addCodec(t){if(this._codecsByName[t.name]||this._codecsByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._codecsByName[t.name]=t,this._codecsByCode[t.code]=t}removeCodec(t){delete this._codecsByName[t.name],delete this._codecsByCode[t.code]}async getCodec(t){const r=typeof t=="string"?this._codecsByName:this._codecsByCode;if(r[t])return r[t];const a=await this._loadCodec(t);return r[t]==null&&this.addCodec(a),a}listCodecs(){return Object.values(this._codecsByName)}}const yt=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class gt{constructor(t){this._hashersByName={},this._hashersByCode={},this._loadHasher=t.loadHasher||yt;for(const r of t.hashers)this.addHasher(r)}addHasher(t){if(this._hashersByName[t.name]||this._hashersByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._hashersByName[t.name]=t,this._hashersByCode[t.code]=t}removeHasher(t){delete this._hashersByName[t.name],delete this._hashersByCode[t.code]}async getHasher(t){const r=typeof t=="string"?this._hashersByName:this._hashersByCode;if(r[t])return r[t];const a=await this._loadHasher(t);return r[t]==null&&this.addHasher(a),a}listHashers(){return Object.values(this._hashersByName)}}const pt="dag-pb",wt=112;function bt(e){$e(e);const t={};return e.Links&&(t.Links=e.Links.map(r=>{const a={};return r.Hash&&(a.Hash=r.Hash.bytes),r.Name!==void 0&&(a.Name=r.Name),r.Tsize!==void 0&&(a.Tsize=r.Tsize),a})),e.Data&&(t.Data=e.Data),ca(t)}function _t(e){const t=ia(e),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(a=>{const s={};try{s.Hash=f.decode(a.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return a.Name!==void 0&&(s.Name=a.Name),a.Tsize!==void 0&&(s.Tsize=a.Tsize),s})),r}var vt=Object.freeze(Object.defineProperty({__proto__:null,name:pt,code:wt,encode:bt,decode:_t,prepare:la,validate:$e,createNode:da,createLink:ua},Symbol.toStringTag,{value:"Module"}));const Pt=c(e=>{async function t(r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).Keys||[]).map(s=>f.parse(s["/"]))}return t}),Et=c(e=>{async function t(r,a={}){return((await(await e.post("bitswap/wantlist",{signal:a.signal,searchParams:i({...a,peer:r.toString()}),headers:a.headers})).json()).Keys||[]).map(n=>f.parse(n["/"]))}return t}),Fe=c(e=>{async function t(r={}){const a=await e.post("bitswap/stat",{searchParams:i(r),signal:r.signal,headers:r.headers});return Ct(await a.json())}return t});function Ct(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(t=>f.parse(t["/"])),peers:(e.Peers||[]).map(t=>$(t)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const Rt=c(e=>{async function t(r,a={}){return(await e.post("bitswap/unwant",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers})).json()}return t});function St(e){return{wantlist:Pt(e),wantlistForPeer:Et(e),unwant:Rt(e),stat:Fe(e)}}const Oe=c(e=>{async function t(r,a={}){const s=await e.post("block/get",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers});return new Uint8Array(await s.arrayBuffer())}return t});function Nt(e){const[t,r]=e[Symbol.asyncIterator]?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],a=[];return{peek:()=>t.next(),push:s=>{a.push(s)},next:()=>a.length?{done:!1,value:a.shift()}:t.next(),[r](){return this}}}var te=Nt;async function*Tt(e,t={}){const r=e.getReader();try{for(;;){const a=await r.read();if(a.done)return;yield a.value}}finally{t.preventCancel!==!0&&r.cancel(),r.releaseLock()}}var G=Tt;const At=async e=>{const t=[];for await(const r of e)t.push(r);return t};var He=At;function L(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function K(e){return e.constructor&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function ie(e){return typeof e=="object"&&(e.path||e.content)}const X=e=>e&&typeof e.getReader=="function";async function It(e){if(L(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(K(e))return e;if(X(e)&&(e=G(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=te(e),{value:r,done:a}=await t.peek();if(a)return Pe(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await He(t))]);if(L(r)||typeof r=="string"||r instanceof String)return Pe(t)}throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function Pe(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}const $t=async function*(e,t){for await(const r of e)yield t(r)};var le=$t;function qe(e){if(e!=null)return typeof e=="number"?e&4095:(e=e.toString(),e.substring(0,1)==="0"?parseInt(e,8)&4095:parseInt(e,10)&4095)}function Ve(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),a=Math.floor(r/1e3);t={secs:a,nsecs:(r-a*1e3)*1e3}}if(!!Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw w(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}async function*jt(e,t){if(typeof e=="string"||e instanceof String||L(e)||K(e)||e._readableState)throw w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(X(e)&&(e=G(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=te(e),{value:a,done:s}=await r.peek();if(s){yield*[];return}if(r.push(a),Number.isInteger(a))throw w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(a._readableState){yield*le(r,n=>oe({content:n},t));return}if(L(a)){yield oe({content:r},t);return}if(ie(a)||a[Symbol.iterator]||a[Symbol.asyncIterator]||X(a)||K(a)){yield*le(r,n=>oe(n,t));return}}throw ie(e)?w(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function oe(e,t){const{path:r,mode:a,mtime:s,content:n}=e,o={path:r||"",mode:qe(a),mtime:Ve(s)};return n?o.content=await t(n):r||(o.content=await t(e)),o}function Bt(e){return jt(e,It)}function Ut(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function U(e,t,r={}){const a=[],s=new FormData;let n=0,o=0;for await(const{content:d,path:l,mode:u,mtime:m}of Bt(e)){let g="";const y=d?"file":"dir";n>0&&(g=`-${n}`);let p=y+g;const C=[];if(u!=null&&C.push(`mode=${Ut(u)}`),m!=null){const{secs:R,nsecs:D}=m;C.push(`mtime=${R}`),D!=null&&C.push(`mtime-nsecs=${D}`)}if(C.length&&(p=`${p}?${C.join("&")}`),d){s.set(p,d,l!=null?encodeURIComponent(l):void 0);const R=o+d.size;a.push({name:l,start:o,end:R}),o=R}else if(l!=null)s.set(p,new File([""],encodeURIComponent(l),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");n++}return{total:o,parts:a,headers:r,body:s}}function kt(e){return e.filter(Boolean)}function k(...e){return ha(kt(e))}const xt=c(e=>{async function t(r,a={}){const s=new AbortController,n=k(s.signal,a.signal);let o;try{o=await(await e.post("block/put",{signal:n,searchParams:i(a),...await U([r],s,a.headers)})).json()}catch(d){if(a.format==="dag-pb")return t(r,{...a,format:"protobuf"});if(a.format==="dag-cbor")return t(r,{...a,format:"cbor"});throw d}return f.parse(o.Key)}return t}),Dt=c(e=>{async function*t(r,a={}){Array.isArray(r)||(r=[r]);const s=await e.post("block/rm",{signal:a.signal,searchParams:i({arg:r.map(n=>n.toString()),"stream-channels":!0,...a}),headers:a.headers});for await(const n of s.ndjson())yield Lt(n)}return t});function Lt(e){const t={cid:f.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const Mt=c(e=>{async function t(r,a={}){const n=await(await e.post("block/stat",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers})).json();return{cid:f.parse(n.Key),size:n.Size}}return t});function Ft(e){return{get:Oe(e),put:xt(e),rm:Dt(e),stat:Mt(e)}}const Ot=c(e=>{async function t(r,a={}){const s=await e.post("bootstrap/add",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),{Peers:n}=await s.json();return{Peers:n.map(o=>new T(o))}}return t}),Ht=c(e=>{async function t(r={}){const a=await e.post("bootstrap/rm",{signal:r.signal,searchParams:i({...r,all:!0}),headers:r.headers}),{Peers:s}=await a.json();return{Peers:s.map(n=>new T(n))}}return t}),qt=c(e=>{async function t(r={}){const a=await e.post("bootstrap/list",{signal:r.signal,searchParams:i(r),headers:r.headers}),{Peers:s}=await a.json();return{Peers:s.map(n=>new T(n))}}return t}),Vt=c(e=>{async function t(r={}){const a=await e.post("bootstrap/add",{signal:r.signal,searchParams:i({...r,default:!0}),headers:r.headers}),{Peers:s}=await a.json();return{Peers:s.map(n=>new T(n))}}return t}),zt=c(e=>{async function t(r,a={}){const s=await e.post("bootstrap/rm",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),{Peers:n}=await s.json();return{Peers:n.map(o=>new T(o))}}return t});function Kt(e){return{add:Ot(e),clear:Ht(e),list:qt(e),reset:Vt(e),rm:zt(e)}}const Xt=c(e=>{async function t(r,a={}){const n=await(await e.post("config/profile/apply",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json();return{original:n.OldCfg,updated:n.NewCfg}}return t});function v(e){if(e==null)return e;const t=/^[A-Z]+$/,r={};return Object.keys(e).reduce((a,s)=>(t.test(s)?a[s.toLowerCase()]=e[s]:t.test(s[0])?a[s[0].toLowerCase()+s.slice(1)]=e[s]:a[s]=e[s],a),r)}const Gt=c(e=>{async function t(r={}){return(await(await e.post("config/profile/list",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).map(n=>v(n))}return t});function Wt(e){return{apply:Xt(e),list:Gt(e)}}const Yt=c(e=>async(r,a={})=>{if(!r)throw new Error("key argument is required");return(await(await e.post("config",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json()).Value}),Qt=c(e=>async(r={})=>await(await e.post("config/show",{signal:r.signal,searchParams:i({...r}),headers:r.headers})).json()),Jt=c(e=>async(r,a={})=>{const s=new AbortController,n=k(s.signal,a.signal);await(await e.post("config/replace",{signal:n,searchParams:i(a),...await U([ae(JSON.stringify(r))],s,a.headers)})).text()}),Zt=c(e=>async(r,a,s={})=>{if(typeof r!="string")throw new Error("Invalid key type");const n={...s,...er(r,a)};await(await e.post("config",{signal:s.signal,searchParams:i(n),headers:s.headers})).text()}),er=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function ar(e){return{getAll:Qt(e),get:Yt(e),set:Zt(e),replace:Jt(e),profiles:Wt(e)}}const tr=c(e=>{async function*t(r,a={}){yield*(await e.post("dag/export",{signal:a.signal,searchParams:i({arg:r.toString()}),headers:a.headers})).iterator()}return t});async function*Ee(e,t,r,a,s){const n=async u=>{const m=await r.getCodec(u.code),g=await a(u,s);return m.decode(g)},o=t.split("/").filter(Boolean);let d=await n(e),l=e;for(;o.length;){const u=o.shift();if(!u)throw w(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(d,u))d=d[u],yield{value:d,remainderPath:o.join("/")};else throw w(new Error(`no link named "${u}" under ${l}`),"ERR_NO_LINK");const m=f.asCID(d);m&&(l=m,d=await n(d))}yield{value:d,remainderPath:""}}const rr=async e=>{for await(const t of e)return t};var sr=rr;const nr=async e=>{let t;for await(const r of e)t=r;return t};var re=nr;const or=(e,t)=>c((a,s)=>{const n=Oe(s);return async(d,l={})=>{if(l.path){const p=l.localResolve?await sr(Ee(d,l.path,e,n,l)):await re(Ee(d,l.path,e,n,l));if(!p)throw w(new Error("Not found"),"ERR_NOT_FOUND");return p}const u=await e.getCodec(d.code),m=await n(d,l);return{value:u.decode(m),remainderPath:""}}})(t),cr=c(e=>{async function*t(r,a={}){const s=new AbortController,n=k(s.signal,a.signal),{headers:o,body:d}=await U(r,s,a.headers),l=await e.post("dag/import",{signal:n,headers:o,body:d,searchParams:i({"pin-roots":a.pinRoots})});for await(const{Root:u}of l.ndjson())if(u!==void 0){const{Cid:{"/":m},PinErrorMsg:g}=u;yield{root:{cid:f.parse(m),pinErrorMsg:g}}}}return t}),ze=(e,t)=>c(a=>async(n,o={})=>{const d={storeCodec:"dag-cbor",hashAlg:"sha2-256",...o};let l;if(d.inputCodec){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");l=n}else l=(await e.getCodec(d.storeCodec)).encode(n),d.inputCodec=d.storeCodec;const u=new AbortController,m=k(u.signal,d.signal),y=await(await a.post("dag/put",{timeout:d.timeout,signal:m,searchParams:i(d),...await U([l],u,d.headers)})).json();return f.parse(y.Cid["/"])})(t),ir=c(e=>async(r,a={})=>{const n=await(await e.post("dag/resolve",{signal:a.signal,searchParams:i({arg:`${r}${a.path?`/${a.path}`.replace(/\/[/]+/g,"/"):""}`,...a}),headers:a.headers})).json();return{cid:f.parse(n.Cid["/"]),remainderPath:n.RemPath}});function lr(e,t){return{export:tr(t),get:or(e,t),import:cr(t),put:ze(e,t),resolve:ir(t)}}const dr=0,ur=1,hr=2,fr=3,mr=4,yr=5,gr=6,pr=7,q=e=>{var t;if(e.Type===dr)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===ur)return{from:$(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:r,Addrs:a})=>({id:$(r),multiaddrs:a.map(s=>new T(s)),protocols:[]})),providers:(e.Responses||[]).map(({ID:r,Addrs:a})=>({id:$(r),multiaddrs:a.map(s=>new T(s)),protocols:[]}))};if(e.Type===hr){let r={id:(t=e.ID)!=null?t:$(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(r={id:$(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(a=>new T(a)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:r}}if(e.Type===fr)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===mr)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:r,Addrs:a})=>({id:$(r),multiaddrs:a.map(s=>new T(s)),protocols:[]}))};if(e.Type===yr)return{name:"VALUE",type:e.Type,value:ae(e.Extra,"base64pad")};if(e.Type===gr){const r=e.Responses.map(({ID:a})=>$(a));if(!r.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:r[0]}}if(e.Type===pr)return{name:"DIALING_PEER",type:e.Type,peer:$(e.ID)};throw new Error("Unknown DHT event type")},wr=c(e=>{async function*t(r,a={}){const s=await e.post("dht/findpeer",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers});for await(const n of s.ndjson())yield q(n)}return t}),br=c(e=>{async function*t(r,a={}){const s=await e.post("dht/findprovs",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers});for await(const n of s.ndjson())yield q(n)}return t}),_r=c(e=>{async function*t(r,a={}){const s=await e.post("dht/get",{signal:a.signal,searchParams:i({arg:r instanceof Uint8Array?je(r):r.toString(),...a}),headers:a.headers});for await(const n of s.ndjson())yield q(n)}return t}),vr=c(e=>{async function*t(r,a={recursive:!1}){const s=Array.isArray(r)?r:[r],n=await e.post("dht/provide",{signal:a.signal,searchParams:i({arg:s.map(o=>o.toString()),...a}),headers:a.headers});for await(const o of n.ndjson())yield q(o)}return t}),Pr=c(e=>{async function*t(r,a,s={}){const n=new AbortController,o=k(n.signal,s.signal),d=await e.post("dht/put",{signal:o,searchParams:i({arg:r instanceof Uint8Array?je(r):r.toString(),...s}),...await U([a],n,s.headers)});for await(const l of d.ndjson())yield q(l)}return t}),Er=c(e=>{async function*t(r,a={}){const s=await e.post("dht/query",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers});for await(const n of s.ndjson())yield q(n)}return t});function Cr(e){return{findPeer:wr(e),findProvs:br(e),get:_r(e),provide:vr(e),put:Pr(e),query:Er(e)}}const Rr=c(e=>{async function t(r={}){return(await e.post("diag/cmds",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()}return t}),Sr=c(e=>{async function t(r={}){return(await e.post("diag/net",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()}return t}),Nr=c(e=>{async function t(r={}){return(await e.post("diag/sys",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()}return t});function Tr(e){return{cmds:Rr(e),net:Sr(e),sys:Nr(e)}}const Ar=c(e=>{async function t(r,a,s={}){await(await e.post("files/chmod",{signal:s.signal,searchParams:i({arg:r,mode:a,...s}),headers:s.headers})).text()}return t}),Ir=c(e=>{async function t(r,a,s={}){const n=Array.isArray(r)?r:[r];await(await e.post("files/cp",{signal:s.signal,searchParams:i({arg:n.concat(a).map(d=>f.asCID(d)?`/ipfs/${d}`:d),...s}),headers:s.headers})).text()}return t}),$r=c(e=>{async function t(r,a={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");const n=await(await e.post("files/flush",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json();return f.parse(n.Cid)}return t});function de(e){const t=v(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const jr=c(e=>{async function*t(r,a={}){if(!r)throw new Error("ipfs.files.ls requires a path");const s=await e.post("files/ls",{signal:a.signal,searchParams:i({arg:f.asCID(r)?`/ipfs/${r}`:r,long:!0,...a,stream:!0}),headers:a.headers});for await(const n of s.ndjson())if("Entries"in n)for(const o of n.Entries||[])yield Ce(de(o));else yield Ce(de(n))}return t});function Ce(e){return e.hash&&(e.cid=f.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}const Br=c(e=>{async function t(r,a={}){await(await e.post("files/mkdir",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).text()}return t}),Ur=c(e=>{async function t(r,a,s={}){Array.isArray(r)||(r=[r]),await(await e.post("files/mv",{signal:s.signal,searchParams:i({arg:r.concat(a),...s}),headers:s.headers})).text()}return t});var kr=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return async function*(){const t=e.getReader();try{for(;;){const{done:r,value:a}=await t.read();if(r)return;yield a}}finally{t.releaseLock()}}();throw new Error("unknown stream")};const xr=c(e=>{async function*t(r,a={}){const s=await e.post("files/read",{signal:a.signal,searchParams:i({arg:r,count:a.length,...a}),headers:a.headers});yield*kr(s.body)}return t}),Dr=c(e=>{async function t(r,a={}){const s=await e.post("files/rm",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),n=await s.text();if(n!==""){const o=new fa.HTTPError(s);throw o.message=n,o}}return t}),Ke=c(e=>{async function t(r,a={}){const n=await(await e.post("files/stat",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json();return n.WithLocality=n.WithLocality||!1,Lr(de(n))}return t});function Lr(e){return e.cid=f.parse(e.hash),delete e.hash,e}const Mr=c(e=>{async function t(r,a={}){await(await e.post("files/touch",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).text()}return t}),Fr=c(e=>{async function t(r,a,s={}){const n=new AbortController,o=k(n.signal,s.signal);await(await e.post("files/write",{signal:o,searchParams:i({arg:r,streamChannels:!0,count:s.length,...s}),...await U([{content:a,path:"arg",mode:ma(s.mode),mtime:ya(s.mtime)}],n,s.headers)})).text()}return t});function Or(e){return{chmod:Ar(e),cp:Ir(e),flush:$r(e),ls:jr(e),mkdir:Br(e),mv:Ur(e),read:xr(e),rm:Dr(e),stat:Ke(e),touch:Mr(e),write:Fr(e)}}const Hr=c(e=>async(r,a,s={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),qr=c(e=>{async function t(r,a={type:"Ed25519"}){const n=await(await e.post("key/gen",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json();return v(n)}return t}),Vr=c(e=>{async function t(r,a,s,n={}){const d=await(await e.post("key/import",{signal:n.signal,searchParams:i({arg:r,pem:a,password:s,...n}),headers:n.headers})).json();return v(d)}return t}),zr=c(e=>async(r,a={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),Kr=c(e=>{async function t(r={}){return((await(await e.post("key/list",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).Keys||[]).map(n=>v(n))}return t}),Xr=c(e=>{async function t(r,a,s={}){const n=await e.post("key/rename",{signal:s.signal,searchParams:i({arg:[r,a],...s}),headers:s.headers});return v(await n.json())}return t}),Gr=c(e=>{async function t(r,a={}){const n=await(await e.post("key/rm",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json();return v(n.Keys[0])}return t});function Wr(e){return{export:Hr(e),gen:qr(e),import:Vr(e),info:zr(e),list:Kr(e),rename:Xr(e),rm:Gr(e)}}const Yr=c(e=>{async function t(r,a,s={}){const n=await e.post("log/level",{signal:s.signal,searchParams:i({arg:[r,a],...s}),headers:s.headers});return v(await n.json())}return t}),Qr=c(e=>{async function t(r={}){return(await(await e.post("log/ls",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).Strings}return t}),Jr=c(e=>{async function*t(r={}){yield*(await e.post("log/tail",{signal:r.signal,searchParams:i(r),headers:r.headers})).ndjson()}return t});function Zr(e){return{level:Yr(e),ls:Qr(e),tail:Jr(e)}}const es=c(e=>{async function t(r,a={}){const s=await e.post("name/publish",{signal:a.signal,searchParams:i({arg:`${r}`,...a}),headers:a.headers});return v(await s.json())}return t}),as=c(e=>{async function*t(r,a={}){const s=await e.post("name/resolve",{signal:a.signal,searchParams:i({arg:r,stream:!0,...a}),headers:a.headers});for await(const n of s.ndjson())yield n.Path}return t}),ts=c(e=>{async function t(r,a={}){const s=await e.post("name/pubsub/cancel",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers});return v(await s.json())}return t}),rs=c(e=>{async function t(r={}){const a=await e.post("name/pubsub/state",{signal:r.signal,searchParams:i(r),headers:r.headers});return v(await a.json())}return t}),ss=c(e=>{async function t(r={}){return(await(await e.post("name/pubsub/subs",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).Strings||[]}return t});function ns(e){return{cancel:ts(e),state:rs(e),subs:ss(e)}}function os(e){return{publish:es(e),resolve:as(e),pubsub:ns(e)}}const cs=c(e=>{async function t(r,a={}){const n=await(await e.post("object/data",{signal:a.signal,searchParams:i({arg:`${r instanceof Uint8Array?f.decode(r):r}`,...a}),headers:a.headers})).arrayBuffer();return new Uint8Array(n,0,n.byteLength)}return t}),is=c(e=>{async function t(r,a={}){const n=await(await e.post("object/get",{signal:a.signal,searchParams:i({arg:`${r instanceof Uint8Array?f.decode(r):r}`,dataEncoding:"base64",...a}),headers:a.headers})).json();return{Data:ae(n.Data,"base64pad"),Links:(n.Links||[]).map(o=>({Name:o.Name,Hash:f.parse(o.Hash),Tsize:o.Size}))}}return t}),ls=c(e=>{async function t(r,a={}){return((await(await e.post("object/links",{signal:a.signal,searchParams:i({arg:`${r instanceof Uint8Array?f.decode(r):r}`,...a}),headers:a.headers})).json()).Links||[]).map(o=>({Name:o.Name,Tsize:o.Size,Hash:f.parse(o.Hash)}))}return t}),ds=c(e=>{async function t(r={}){const a=await e.post("object/new",{signal:r.signal,searchParams:i({arg:r.template,...r}),headers:r.headers}),{Hash:s}=await a.json();return f.parse(s)}return t}),us=(e,t)=>c(a=>{const s=ze(e,t);async function n(o,d={}){return s(o,{...d,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return n})(t),hs=c(e=>{async function t(r,a={}){const n=await(await e.post("object/stat",{signal:a.signal,searchParams:i({arg:`${r}`,...a}),headers:a.headers})).json();return{...n,Hash:f.parse(n.Hash)}}return t}),fs=c(e=>{async function t(r,a,s={}){const n=await e.post("object/patch/add-link",{signal:s.signal,searchParams:i({arg:[`${r}`,a.Name||a.name||"",(a.Hash||a.cid||"").toString()||null],...s}),headers:s.headers}),{Hash:o}=await n.json();return f.parse(o)}return t}),ms=c(e=>{async function t(r,a,s={}){const n=new AbortController,o=k(n.signal,s.signal),d=await e.post("object/patch/append-data",{signal:o,searchParams:i({arg:`${r}`,...s}),...await U([a],n,s.headers)}),{Hash:l}=await d.json();return f.parse(l)}return t}),ys=c(e=>{async function t(r,a,s={}){const n=await e.post("object/patch/rm-link",{signal:s.signal,searchParams:i({arg:[`${r}`,a.Name||a.name||null],...s}),headers:s.headers}),{Hash:o}=await n.json();return f.parse(o)}return t}),gs=c(e=>{async function t(r,a,s={}){const n=new AbortController,o=k(n.signal,s.signal),d=await e.post("object/patch/set-data",{signal:o,searchParams:i({arg:[`${r}`],...s}),...await U([a],n,s.headers)}),{Hash:l}=await d.json();return f.parse(l)}return t});function ps(e){return{addLink:fs(e),appendData:ms(e),rmLink:ys(e),setData:gs(e)}}function ws(e,t){return{data:cs(t),get:is(t),links:ls(t),new:ds(t),put:us(e,t),stat:hs(t),patch:ps(t)}}async function*Xe(e){if(e==null)throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=f.asCID(e);if(t){yield j({cid:t});return}if(e instanceof String||typeof e=="string"){yield j({path:e});return}if(e.cid!=null||e.path!=null)return yield j(e);if(Symbol.iterator in e){const r=e[Symbol.iterator](),a=r.next();if(a.done)return r;if(f.asCID(a.value)||a.value instanceof String||typeof a.value=="string"){yield j({cid:a.value});for(const s of r)yield j({cid:s});return}if(a.value.cid!=null||a.value.path!=null){yield j(a.value);for(const s of r)yield j(s);return}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(Symbol.asyncIterator in e){const r=e[Symbol.asyncIterator](),a=await r.next();if(a.done)return r;if(f.asCID(a.value)||a.value instanceof String||typeof a.value=="string"){yield j({cid:a.value});for await(const s of r)yield j({cid:s});return}if(a.value.cid!=null||a.value.path!=null){yield j(a.value);for await(const s of r)yield j(s);return}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw w(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}function j(e){const t=e.cid||`${e.path}`;if(!t)throw w(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:e.recursive!==!1};return e.metadata!=null&&(r.metadata=e.metadata),r}const Ge=c(e=>{async function*t(r,a={}){for await(const{path:s,recursive:n,metadata:o}of Xe(r)){const d=await e.post("pin/add",{signal:a.signal,searchParams:i({...a,arg:s,recursive:n,metadata:o?JSON.stringify(o):void 0,stream:!0}),headers:a.headers});for await(const l of d.ndjson()){if(l.Pins){for(const u of l.Pins)yield f.parse(u);continue}yield f.parse(l)}}}return t});function bs(e){const t=Ge(e);return c(()=>{async function r(a,s={}){return re(t([{path:a,...s}],s))}return r})(e)}function Re(e,t,r){const a={type:e,cid:f.parse(t)};return r&&(a.metadata=r),a}const _s=c(e=>{async function*t(r={}){let a=[];r.paths&&(a=Array.isArray(r.paths)?r.paths:[r.paths]);const s=await e.post("pin/ls",{signal:r.signal,searchParams:i({...r,arg:a.map(n=>`${n}`),stream:!0}),headers:r.headers});for await(const n of s.ndjson()){if(n.Keys){for(const o of Object.keys(n.Keys))yield Re(n.Keys[o].Type,o,n.Keys[o].Metadata);return}yield Re(n.Type,n.Cid,n.Metadata)}}return t}),We=c(e=>{async function*t(r,a={}){for await(const{path:s,recursive:n}of Xe(r)){const o=new URLSearchParams(a.searchParams);o.append("arg",`${s}`),n!=null&&o.set("recursive",String(n));const d=await e.post("pin/rm",{signal:a.signal,headers:a.headers,searchParams:i({...a,arg:`${s}`,recursive:n})});for await(const l of d.ndjson()){if(l.Pins){yield*l.Pins.map(u=>f.parse(u));continue}yield f.parse(l)}}}return t}),vs=e=>{const t=We(e);return c(()=>{async function r(a,s={}){return re(t([{path:a,...s}],s))}return r})(e)},Ye=({Name:e,Status:t,Cid:r})=>({cid:f.parse(r),name:e,status:t}),Qe=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},Je=e=>{if(f.asCID(e))return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},me=({service:e,cid:t,name:r,status:a,all:s})=>{const n=i({service:Qe(e),name:r,force:s?!0:void 0});if(t)for(const o of t)n.append("cid",Je(o));if(a)for(const o of a)n.append("status",o);return n},Ps=({cid:e,service:t,background:r,name:a,origins:s})=>{const n=i({arg:Je(e),service:Qe(t),name:a,background:r?!0:void 0});if(s)for(const o of s)n.append("origin",o.toString());return n};function Es(e){async function t(r,{timeout:a,signal:s,headers:n,...o}){const d=await e.post("pin/remote/add",{timeout:a,signal:s,headers:n,searchParams:Ps({cid:r,...o})});return Ye(await d.json())}return t}function Cs(e){async function*t({timeout:r,signal:a,headers:s,...n}){const o=await e.post("pin/remote/ls",{timeout:r,signal:a,headers:s,searchParams:me(n)});for await(const d of o.ndjson())yield Ye(d)}return t}function Rs(e){async function t({timeout:r,signal:a,headers:s,...n}){await e.post("pin/remote/rm",{timeout:r,signal:a,headers:s,searchParams:me({...n,all:!1})})}return t}function Ss(e){async function t({timeout:r,signal:a,headers:s,...n}){await e.post("pin/remote/rm",{timeout:r,signal:a,headers:s,searchParams:me({...n,all:!0})})}return t}function Ns(e){const t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}function Ts(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:As(e.Stat)}}}function As(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:a,Failed:s}=e.PinCount;return{status:"valid",pinCount:{queued:a,pinning:t,pinned:r,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function Is(e){async function t(r,a){const{endpoint:s,key:n,headers:o,timeout:d,signal:l}=a;await e.post("pin/remote/service/add",{timeout:d,signal:l,searchParams:i({arg:[r,Ns(s),n]}),headers:o})}return t}function $s(e){async function t(r={}){const{stat:a,headers:s,timeout:n,signal:o}=r,d=await e.post("pin/remote/service/ls",{timeout:n,signal:o,headers:s,searchParams:a===!0?i({stat:a}):void 0}),{RemoteServices:l}=await d.json();return l.map(Ts)}return t}function js(e){async function t(r,a={}){await e.post("pin/remote/service/rm",{signal:a.signal,headers:a.headers,searchParams:i({arg:r})})}return t}function Bs(e){const t=new Be(e);return{add:Is(t),ls:$s(t),rm:js(t)}}function Us(e){const t=new Be(e);return{add:Es(t),ls:Cs(t),rm:Rs(t),rmAll:Ss(t),service:Bs(e)}}function ks(e){return{addAll:Ge(e),add:bs(e),ls:_s(e),rmAll:We(e),rm:vs(e),remote:Us(e)}}const xs=c(e=>{async function t(r={}){const{Strings:a}=await(await e.post("pubsub/ls",{signal:r.signal,searchParams:i(r),headers:r.headers})).json();return ga(a)||[]}return t}),Ds=c(e=>{async function t(r,a={}){const s=await e.post("pubsub/peers",{signal:a.signal,searchParams:i({arg:Ue(r),...a}),headers:a.headers}),{Strings:n}=await s.json();return n||[]}return t}),Ls=c(e=>{async function t(r,a,s={}){const n=i({arg:Ue(r),...s}),o=new AbortController,d=k(o.signal,s.signal);await(await e.post("pubsub/pub",{signal:d,searchParams:n,...await U([a],o,s.headers)})).text()}return t}),Ms=(e,t)=>{async function r(a,s){t.unsubscribe(a,s)}return r};class Fs{constructor(){this._subs=new Map}subscribe(t,r,a){const s=this._subs.get(t)||[];if(s.find(o=>o.handler===r))throw new Error(`Already subscribed to ${t} with this handler`);const n=new AbortController;return this._subs.set(t,[{handler:r,controller:n}].concat(s)),a&&a.addEventListener("abort",()=>this.unsubscribe(t,r)),n.signal}unsubscribe(t,r){const a=this._subs.get(t)||[];let s;r?(this._subs.set(t,a.filter(n=>n.handler!==r)),s=a.filter(n=>n.handler===r)):(this._subs.set(t,[]),s=a),(this._subs.get(t)||[]).length||this._subs.delete(t),s.forEach(n=>n.controller.abort())}}function Os(e){const t=new Fs;return{ls:xs(e),peers:Ds(e),publish:Ls(e),subscribe:pa(e,t),unsubscribe:Ms(e,t)}}const Hs=c(e=>{async function*t(r={}){yield*(await e.post("refs/local",{signal:r.signal,transform:v,searchParams:i(r),headers:r.headers})).ndjson()}return t}),qs=c((e,t)=>Object.assign(async function*(a,s={}){const n=Array.isArray(a)?a:[a];yield*(await e.post("refs",{signal:s.signal,searchParams:i({arg:n.map(d=>`${d instanceof Uint8Array?f.decode(d):d}`),...s}),headers:s.headers,transform:v})).ndjson()},{local:Hs(t)})),Vs=c(e=>{async function*t(r={}){yield*(await e.post("repo/gc",{signal:r.signal,searchParams:i(r),headers:r.headers,transform:s=>({err:s.Error?new Error(s.Error):null,cid:(s.Key||{})["/"]?f.parse(s.Key["/"]):null})})).ndjson()}return t}),Ze=c(e=>{async function t(r={}){const s=await(await e.post("repo/stat",{signal:r.signal,searchParams:i(r),headers:r.headers})).json();return{numObjects:BigInt(s.NumObjects),repoSize:BigInt(s.RepoSize),repoPath:s.RepoPath,version:s.Version,storageMax:BigInt(s.StorageMax)}}return t}),zs=c(e=>{async function t(r={}){return(await(await e.post("repo/version",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()).Version}return t});function Ks(e){return{gc:Vs(e),stat:Ze(e),version:zs(e)}}const Xs=c(e=>{async function*t(r={}){yield*(await e.post("stats/bw",{signal:r.signal,searchParams:i(r),headers:r.headers,transform:s=>({totalIn:BigInt(s.TotalIn),totalOut:BigInt(s.TotalOut),rateIn:parseFloat(s.RateIn),rateOut:parseFloat(s.RateOut)})})).ndjson()}return t});function Gs(e){return{bitswap:Fe(e),repo:Ze(e),bw:Xs(e)}}const Ws=c(e=>{async function t(r={}){const a=await e.post("swarm/addrs",{signal:r.signal,searchParams:i(r),headers:r.headers}),{Addrs:s}=await a.json();return Object.keys(s).map(n=>({id:$(n),addrs:(s[n]||[]).map(o=>new T(o))}))}return t}),Ys=c(e=>{async function t(r,a={}){const s=await e.post("swarm/connect",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),{Strings:n}=await s.json();return n||[]}return t}),Qs=c(e=>{async function t(r,a={}){const s=await e.post("swarm/disconnect",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),{Strings:n}=await s.json();return n||[]}return t}),Js=c(e=>{async function t(r={}){const a=await e.post("swarm/addrs/local",{signal:r.signal,searchParams:i(r),headers:r.headers}),{Strings:s}=await a.json();return(s||[]).map(n=>new T(n))}return t}),Zs=c(e=>{async function t(r={}){const a=await e.post("swarm/peers",{signal:r.signal,searchParams:i(r),headers:r.headers}),{Peers:s}=await a.json();return(s||[]).map(n=>({addr:new T(n.Addr),peer:$(n.Peer),muxer:n.Muxer,latency:n.Latency,streams:n.Streams,direction:n.Direction==null?void 0:n.Direction===0?"inbound":"outbound"}))}return t});function en(e){return{addrs:Ws(e),connect:Ys(e),disconnect:Qs(e),localAddrs:Js(e),peers:Zs(e)}}const ea=c(e=>{async function*t(r,a={}){const s=new AbortController,n=k(s.signal,a.signal),{headers:o,body:d,total:l,parts:u}=await U(r,s,a.headers),[m,g]=typeof a.progress=="function"?an(l,u,a.progress):[void 0,void 0],y=await e.post("add",{searchParams:i({"stream-channels":!0,...a,progress:Boolean(m)}),onUploadProgress:g,signal:n,headers:o,body:d});for await(let p of y.ndjson())p=v(p),p.hash!==void 0?yield rn(p):m&&m(p.bytes||0,p.name)}return t}),an=(e,t,r)=>t?[void 0,tn(e,t,r)]:[r,void 0],tn=(e,t,r)=>{let a=0;const s=t.length;return({loaded:n,total:o})=>{const d=Math.floor(n/o*e);for(;a<s;){const{start:l,end:u,name:m}=t[a];if(d<u){r(d-l,m);break}else r(u-l,m),a+=1}}};function rn({name:e,hash:t,size:r,mode:a,mtime:s,mtimeNsecs:n}){const o={path:e,cid:f.parse(t),size:parseInt(r)};return a!=null&&(o.mode=parseInt(a,8)),s!=null&&(o.mtime={secs:s,nsecs:n||0}),o}const Se=G;function sn(e){return typeof e.stream=="function"?Se(e.stream()):Se(new Response(e).body)}var nn=sn;async function*W(e){yield e}async function on(e){if(L(e))return W(ce(e));if(typeof e=="string"||e instanceof String)return W(ce(e.toString()));if(K(e))return nn(e);if(X(e)&&(e=G(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=te(e),{value:r,done:a}=await t.peek();if(a)return W(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return W(Uint8Array.from(await He(t)));if(L(r)||typeof r=="string"||r instanceof String)return le(t,ce)}throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function ce(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):ae(e.toString())}async function*cn(e,t){if(e==null)throw w(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield Y(e.toString(),t);return}if(L(e)||K(e)){yield Y(e,t);return}if(X(e)&&(e=G(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=te(e),{value:a,done:s}=await r.peek();if(s){yield{content:[]};return}if(r.push(a),Number.isInteger(a)||L(a)||typeof a=="string"||a instanceof String){yield Y(r,t);return}throw w(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(ie(e)){yield Y(e,t);return}throw w(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function Y(e,t){const{path:r,mode:a,mtime:s,content:n}=e,o={path:r||"",mode:qe(a),mtime:Ve(s)};return n?o.content=await t(n):r||(o.content=await t(e)),o}function ln(e){return cn(e,on)}function dn(e){const t=ea(e);return c(()=>{async function r(a,s={}){return await re(t(ln(a),s))}return r})(e)}const un=c(e=>{async function*t(r,a={}){yield*(await e.post("cat",{signal:a.signal,searchParams:i({arg:r.toString(),...a}),headers:a.headers})).iterator()}return t}),hn=c(e=>async(r={})=>(await e.post("commands",{signal:r.signal,searchParams:i(r),headers:r.headers})).json()),fn=c(e=>async(r,a={})=>(await(await e.post("dns",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers})).json()).Path),mn=c(e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}),yn=c(e=>{async function*t(r,a={}){const s={arg:`${r instanceof Uint8Array?f.decode(r):r}`,...a};s.compressionLevel&&(s["compression-level"]=s.compressionLevel,delete s.compressionLevel),yield*(await e.post("get",{signal:a.signal,searchParams:i(s),headers:a.headers})).iterator()}return t}),aa=c(e=>{async function t(r={}){const s=await(await e.post("id",{signal:r.signal,searchParams:i({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),n={...v(s)};return n.id=$(n.id),n.addresses&&(n.addresses=n.addresses.map(o=>new T(o))),n}return t}),gn=e=>{const t=aa(e);async function r(a={}){const s=await t(a);return Boolean(s&&s.addresses&&s.addresses.length)}return r},pn=c((e,t)=>{async function*r(a,s={}){const n=`${a instanceof Uint8Array?f.decode(a):a}`;async function o(l){let u=l.Hash;if(u.includes("/")){const g=u.startsWith("/ipfs/")?u:`/ipfs/${u}`;u=(await Ke(t)(g)).cid}else u=f.parse(u);const m={name:l.Name,path:n+(l.Name?`/${l.Name}`:""),size:l.Size,cid:u,type:wn(l)};return l.Mode&&(m.mode=parseInt(l.Mode,8)),l.Mtime!==void 0&&l.Mtime!==null&&(m.mtime={secs:l.Mtime},l.MtimeNsecs!==void 0&&l.MtimeNsecs!==null&&(m.mtime.nsecs=l.MtimeNsecs)),m}const d=await e.post("ls",{signal:s.signal,searchParams:i({arg:n,...s}),headers:s.headers});for await(let l of d.ndjson()){if(l=l.Objects,!l)throw new Error("expected .Objects in results");if(l=l[0],!l)throw new Error("expected one array in results.Objects");const u=l.Links;if(!Array.isArray(u))throw new Error("expected one array in results.Objects[0].Links");if(!u.length){yield o(l);return}yield*u.map(o)}}return r});function wn(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const bn=c(e=>{async function t(r={}){const a=await e.post("dns",{signal:r.signal,searchParams:i(r),headers:r.headers});return v(await a.json())}return t}),_n=c(e=>{async function*t(r,a={}){yield*(await e.post("ping",{signal:a.signal,searchParams:i({arg:`${r}`,...a}),headers:a.headers,transform:v})).ndjson()}return t}),vn=c(e=>{async function t(r,a={}){const s=await e.post("resolve",{signal:a.signal,searchParams:i({arg:r,...a}),headers:a.headers}),{Path:n}=await s.json();return n}return t}),Pn=c(e=>async(r={})=>{throw w(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),En=c(e=>{async function t(r={}){await(await e.post("shutdown",{signal:r.signal,searchParams:i(r),headers:r.headers})).text()}return t}),Cn=c(e=>{async function t(r={}){const a=await e.post("version",{signal:r.signal,searchParams:i(r),headers:r.headers});return{...v(await a.json()),"ipfs-http-client":"1.0.0"}}return t});function Rn(e={}){const t={name:pe.name,code:pe.code,encode:u=>u,decode:u=>u},r=Object.values(wa);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(u=>r.push(u));const a=new ht({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),s=Object.values(ba);[vt,_a,va,Pa,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(u=>s.push(u));const n=new mt({codecs:s,loadCodec:e.ipld&&e.ipld.loadCodec}),o=Object.values(Ea);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(u=>o.push(u));const d=new gt({hashers:o,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:dn(e),addAll:ea(e),bitswap:St(e),block:Ft(e),bootstrap:Kt(e),cat:un(e),commands:hn(e),config:ar(e),dag:lr(n,e),dht:Cr(e),diag:Tr(e),dns:fn(e),files:Or(e),get:yn(e),getEndpointConfig:mn(e),id:aa(e),isOnline:gn(e),key:Wr(e),log:Zr(e),ls:pn(e),mount:bn(e),name:os(e),object:ws(n,e),pin:ks(e),ping:_n(e),pubsub:Os(e),refs:qs(e),repo:Ks(e),resolve:vn(e),start:Pn(e),stats:Gs(e),stop:En(e),swarm:en(e),version:Cn(e),bases:a,codecs:n,hashers:d}}const Sn={fileUrl:null,name:null,description:null,properties:[],collection:null,approveRights:!1,agreenTerms:!1},Nn=he({__name:"create",setup(e,{expose:t}){t();const r="https://ipfs.infura.io/ipfs/QmUC4RmLypFruXTFNn51ZuqAmt4BFzLEpm8n3Wjg3sLP1a",a=Rn({url:ne+Ta+"/api/v0"}),{account:s,library:n,chainId:o}=Ne(),d=Ca(),{$compare:l}=Ra(),u=De(),m=Le(),g=Me(),y=Sn;Te([s,n,g],()=>{!!n.value&&!!s.value&&(se(),V())});const p=M(null),C=M("0"),R=M(!1),D=M(!1);async function V(){const E=B[o.value],b=new n.value.eth.Contract(H,E);p.value=await b.methods.newNFTFeeToken().call(),C.value=await b.methods.newNFTFeeAmount().call();const _=new n.value.eth.Contract(ve,p.value),A=await _.methods.balanceOf(s.value).call();O.exports.greaterThanOrEqual(O.exports.BigInt(A),O.exports.BigInt(C.value))?R.value=!0:R.value=!1;const I=await _.methods.allowance(s.value,E).call();O.exports.greaterThanOrEqual(O.exports.BigInt(I),O.exports.BigInt(C.value))?D.value=!0:D.value=!1}const F=M([]);function se(){const E=new n.value.eth.Contract(H,B[o.value]);F.value=[],E.methods.getCollectionTokenList().call({from:s.value}).then(async b=>{if(b.length>0){const _=b.map(async A=>{const I=await E.methods.collectionMap(A).call();I.owner===s.value&&F.value.push(I)});await Promise.all(_),F.value.length>0&&(F.value.sort(l("createTime")),y.collection=F.value[0].token)}})}async function ta(E){u.value=!0;const b=E.target.files[0];try{const _=await a.add(b,{progress:I=>console.log(`received: ${I}`)}),A=`${ne}${_e}/${_.path}`;y.fileUrl=A,u.value=!1}catch(_){console.log("Error uploading file: ",_),y.fileUrl=null,u.value=!1}}const P=Sa("propertiesList",()=>[{property:null,value:null}]);function ra(E,b,_){if(b==="property"?P.value[_].property=E.target.value:b==="value"&&(P.value[_].value=E.target.value),P.value[_].property&&P.value[_].value&&(P.value[_+1]||P.value.push({property:null,value:null})),!P.value[_].property||!P.value[_].value){const A=P.value.length;A>_+1&&!P.value[A-1].property&&!P.value[A-1].value&&P.value.pop()}}async function sa(){if(m.value=!0,u.value=!0,y.fileUrl&&y.name&&y.collection&&y.approveRights&&y.agreenTerms){P.value.length>0&&P.value.map(b=>{b.property&&b.value&&y.properties.push(b)});const E=JSON.stringify(y);try{const b=await a.add(E),_=`${ne}${_e}/${b.path}`,A=B[o.value],I=new n.value.eth.Contract(Ia,y.collection),ge=await I.methods.MINTER_ROLE().call();await I.methods.hasRole(ge,A).call()||await I.methods.grantRole(ge,A).send({from:s.value}),await I.methods.isApprovedForAll(s.value,B[o.value]).call()||await I.methods.setApprovalForAll(B[o.value],!0).send({from:s.value}),new n.value.eth.Contract(H,B[o.value]).methods.newNFT(y.collection,s.value,_).send({from:s.value}).then(oa=>{V(),u.value=!1,d.push("/account/nfts")}).catch(oa=>{u.value=!1})}catch(b){console.log("Error uploading file: ",b),u.value=!1}}else u.value=!1}async function na(){if(u.value=!0,!!s.value&&!!o.value&&y.collection)try{D.value||(await new n.value.eth.Contract(ve,p.value).methods.approve(B[o.value],C.value).send({from:s.value}),D.value=!0),await new n.value.eth.Contract(H,B[o.value]).methods.newNFT(y.collection,s.value,r).send({from:s.value}),V(),u.value=!1}catch(E){console.info(E),u.value=!1}else u.value=!1}Ae(()=>{!!n.value&&!!s.value&&!!o.value&&(se(),V())});const ye={commonURI:r,client:a,account:s,library:n,chainId:o,router:d,$compare:l,loading:u,isSubmit:m,timestamp:g,formModel:y,newNFTFeeToken:p,newNFTFeeAmount:C,ableBalance:R,ableApprove:D,queryBalanceAndApprove:V,collectionList:F,refreshCollection:se,uploadLogo:ta,propertiesList:P,changeProperties:ra,createNft:sa,createNftTest:na};return Object.defineProperty(ye,"__isScriptSetup",{enumerable:!1,value:!0}),ye}}),Tn={key:0},An=h("div",{class:"pb-5 text-center"},[h("h2",null,"Create NFTs"),h("p",{class:"lead fw-lighter"},"NFTs can represent essentially any type of digital file, with artists creating NFTs featuring pictures, videos, gifs, audio files, and mixtures of them all. There are also utility NFT tokens, which provide a good or service and contain inherent value coded within them, what's your vision?")],-1),In={class:"row g-5"},$n={class:"col"},jn={class:"row g-3"},Bn={class:"col-12"},Un=h("label",{for:"uploadFile",class:"form-label"},"Upload File",-1),kn=h("p",{class:"fw-lighter"},"Add your unique image / video / audio file",-1),xn={key:0,class:"text-center"},Dn=["src"],Ln=h("div",{class:"invalid-feedback"}," You must upload a file ",-1),Mn={class:"col-12"},Fn=h("label",{for:"name",class:"form-label"},"Name",-1),On=h("p",{class:"fw-lighter"},"Choose a unique name for your NFT",-1),Hn=h("div",{class:"invalid-feedback"}," You must choose a name ",-1),qn={class:"col-12"},Vn=h("label",{for:"description",class:"form-label"},"Description",-1),zn=h("p",{class:"fw-lighter"},"Describe your NFT, help other users understand what's unique about it",-1),Kn={class:"col-12"},Xn=h("label",{for:"properties",class:"form-label"},"Properties",-1),Gn=h("p",{class:"fw-lighter"},"List attributes that represents your NFT (color, shape, mood, etc..)",-1),Wn={class:"col-6"},Yn=["id","onInput","value"],Qn={class:"col-6"},Jn=["id","onInput","value"],Zn={class:"col-12"},eo={for:"collection",class:"form-label"},ao=fe(" Collection "),to=h("p",{class:"fw-lighter"},"The collection where your NFT will appear.",-1),ro={class:"input-group has-validation"},so=["value"],no=h("i",{class:"bi bi-arrow-repeat"},null,-1),oo=[no],co=h("div",{class:"invalid-feedback"}," You must choose / create a collection ",-1),io=h("hr",{class:"my-4"},null,-1),lo=h("p",{class:"fw-semibold fst-italic"},"Note, the process of minting an NFT is an irreversible process, make sure all the above details are right.",-1),uo={class:"form-check"},ho=h("label",{class:"form-check-label fw-lighter",for:"approveRights"},"I approve that I'm the owner or have the rights of publication and sale.",-1),fo={class:"form-check"},mo=h("label",{class:"form-check-label fw-lighter",for:"agreenTerms"},"I approve NFTrade's Terms & Conditions",-1),yo=h("hr",{class:"my-4"},null,-1),go=["disabled"],po={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},wo={key:1,class:"w-100 btn btn-primary btn-lg",type:"button",disabled:""},bo={key:1},_o={class:"pb-5 text-center"};function vo(e,t,r,a,s,n){const o=dt,d=xe,l=Aa;return a.account?(S(),N("div",Tn,[An,h("div",In,[h("div",$n,[h("form",{class:Ie(`needs-validation ${a.isSubmit?"was-validated":""}`),novalidate:""},[h("div",jn,[h("div",Bn,[Un,kn,h("input",{class:"form-control",type:"file",id:"uploadFile",onChange:a.uploadLogo,required:""},null,32),a.formModel.fileUrl?(S(),N("div",xn,[h("img",{src:a.formModel.fileUrl,class:"rounded",alt:""},null,8,Dn)])):Q("",!0),Ln]),h("div",Mn,[Fn,On,x(h("input",{type:"text",class:"form-control",id:"name",placeholder:"Enter the NFT's name","onUpdate:modelValue":t[0]||(t[0]=u=>a.formModel.name=u),required:""},null,512),[[J,a.formModel.name]]),Hn]),h("div",qn,[Vn,zn,x(h("textarea",{class:"form-control",id:"description",rows:"3",placeholder:"Enter the NFT's description","onUpdate:modelValue":t[1]||(t[1]=u=>a.formModel.description=u)},null,512),[[J,a.formModel.description]])]),h("div",Kn,[Xn,Gn,(S(!0),N(we,null,be(a.propertiesList,(u,m)=>(S(),N("div",{class:"row my-3",key:m},[h("div",Wn,[h("input",{type:"text",class:"form-control",id:`property-${m}`,placeholder:"Property",onInput:g=>a.changeProperties(g,"property",m),value:u.property},null,40,Yn)]),h("div",Qn,[h("input",{type:"text",class:"form-control",id:`value-${m}`,placeholder:"Value",onInput:g=>a.changeProperties(g,"value",m),value:u.value},null,40,Jn)])]))),128))]),h("div",Zn,[h("label",eo,[ao,z(d,null,{default:ke(()=>[z(o)]),_:1})]),to,h("div",ro,[x(h("select",{class:"form-select",id:"collection","onUpdate:modelValue":t[2]||(t[2]=u=>a.formModel.collection=u),"aria-label":"Select a Collection",placeholder:"Select a Collection",required:""},[(S(!0),N(we,null,be(a.collectionList,u=>(S(),N("option",{key:u.token,value:u.token},Z(u.name),9,so))),128))],512),[[Na,a.formModel.collection]]),h("button",{class:"btn btn-outline-secondary",type:"button",onClick:a.refreshCollection},oo),co])])]),io,lo,h("div",uo,[x(h("input",{type:"checkbox",class:"form-check-input",id:"approveRights","onUpdate:modelValue":t[3]||(t[3]=u=>a.formModel.approveRights=u),required:""},null,512),[[ee,a.formModel.approveRights]]),ho]),h("div",fo,[x(h("input",{type:"checkbox",class:"form-check-input",id:"agreenTerms","onUpdate:modelValue":t[4]||(t[4]=u=>a.formModel.agreenTerms=u),required:""},null,512),[[ee,a.formModel.agreenTerms]]),mo]),yo,a.ableBalance?(S(),N("button",{key:0,class:"w-100 btn btn-primary btn-lg",type:"button",disabled:a.loading,onClick:a.createNftTest},[a.loading?(S(),N("span",po)):Q("",!0),fe(" "+Z(a.loading?"Loading...":"Create"),1)],8,go)):a.ableBalance?Q("",!0):(S(),N("button",wo," Insufficient Balance "))],2)])])])):(S(),N("div",bo,[h("div",_o,[z(l)])]))}var Po=ue(Nn,[["render",vo]]);const Eo=he({__name:"index",setup(e,{expose:t}){t();const r={};return Object.defineProperty(r,"__isScriptSetup",{enumerable:!1,value:!0}),r}}),Co={class:"container py-5"};function Ro(e,t,r,a,s,n){const o=Po,d=xe;return S(),N("main",null,[h("div",Co,[z(d,null,{default:ke(()=>[z(o)]),_:1})])])}var xo=ue(Eo,[["render",Ro]]);export{xo as default};
